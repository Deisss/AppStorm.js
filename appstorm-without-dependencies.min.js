/*! appstorm.js - v0.2.8 - 19-04-2015 */
window.appstorm=window.a=_.cloneDeep(_.noConflict()),a.url="",a.scope=function(a,b){return function(){return a.apply(b,arguments)}},a.getStackTrace=function(){var a=new Error;return a.stack},a.isNone=function(b){return a.isNull(b)||a.isUndefined(b)},a.isTrueObject=function(b){return"object"==typeof b&&!a.isNone(b)},a.trim=function(a){return String.prototype.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},a.firstLetterUppercase=function(a,b){return b=b||"",b+a.charAt(0).toUpperCase()+a.slice(1)},a.deepClone=function(b){if(a.isTrueObject(b)&&!a.isFunction(b)){if(a.isArray(b)){for(var c=b.length,d=new Array(c),e=0;c>e;++e)d[e]=a.deepClone(b[e]);return d}var d={};a.isFunction(b.constructor)&&(d=new b.constructor),a.isTrueObject(b.prototype)&&(d.prototype=b.prototype);for(var f in b)d[f]=a.deepClone(b[f]);return d}return b},a.differenceObject=function(b,c){var d=a.difference(a.keys(b),a.keys(c)),e={};return a.each(d,function(a){e[a]=this[a]},b),e},a.extend=function(a,b,c){if(!a)return a;var d=arguments,e=0,f=d.length,g=typeof c;for("number"!=g&&"string"!=g||!d[3]||d[3][c]!==b||(f=2);++e<f;)if(b=d[e])for(var h in b)a[h]=b[h];return a},a.watch=function(){WatchJS.watch.apply(this,arguments)},a.unwatch=function(){WatchJS.unwatch.apply(this,arguments)},a.setDefaultAjaxOptions=function(b){a.isTrueObject(b)&&a.mem.set("app.ajax.default",b)},a.getDefaultAjaxOptions=function(){return a.mem.get("app.ajax.default")||{}},a.setTemplateAjaxOptions=function(b,c){b&&a.isTrueObject(c)&&a.mem.set("app.ajax.template."+b,c)},a.getTemplateAjaxOptions=function(b){return a.mem.get("app.ajax.template."+b)},a.setAjaxBefore=function(b,c){b&&a.isFunction(c)&&a.mem.set("app.ajax.before."+b,c)},a.getAjaxBefore=function(b){return a.mem.get("app.ajax.before."+b)||null},a.setAjaxAfter=function(b,c){b&&a.isFunction(c)&&a.mem.set("app.ajax.after."+b,c)},a.getAjaxAfter=function(b){return a.mem.get("app.ajax.after."+b)||null},function(){var b=document.getElementById("a-core");b&&!a.isNone(b.src)&&(a.url=b.src.replace(new RegExp("/[^/]*$"),"/"))}(),function(){Handlebars.registerHelper("debug",function(b){a.console.log("===== CONTEXT ======"),a.console.log(this),a.isUndefined(b)||(a.console.log("====== VALUE ======="),a.console.log(b))}),Handlebars.registerHelper("count",function(b){a.console.log("=== DEBUG COUNT ===="),a.isUndefined(b.length)?(a.console.log("Length is not defined for value"),a.console.log(b)):a.console.log(b.length)})}(),a.mem=function(){function b(b){if(!a.isString(b))return null;for(b=b.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ");b.indexOf("..")>=0;)b=b.replace(/(\.\.)/g,".");return"."==b.charAt(0)&&(b=b.substring(1)),"."==b.charAt(b.length-1)&&(b=b.substr(0,b.length-1)),b}function c(c){if(c=b(c)){var d=h[c];if(!a.isUndefined(d))return d}return null}function d(c){var d=b(c);if(d){var e={};return a.each(h,function(a,b){if(0===b.indexOf(d)){var c=b.substring(d.length+1);e[c]=a}}),e}return h}function e(a,c){a=b(a),a&&(h[a]=c)}function f(a){a=b(a),delete h[a]}function g(a){for(var b in h)0===b.indexOf(a)&&delete h[b]}var h={},i=function(a){this.prefix=a};i.prototype={get:function(a){return c(this.prefix+"."+a)},list:function(){return d(this.prefix)},set:function(a,b){e(this.prefix+"."+a,b)},remove:function(a){f(this.prefix+"."+a)},clear:function(){this.prefix&&g(this.prefix)}};var j=new i("");return j.getInstance=function(a){return new i(a)},j}(),function(){Handlebars.registerHelper("mem",function(b){return new Handlebars.SafeString(a.mem.get(b))})}(),a.environment=a.mem.getInstance("app.environment"),a.environment.set("app.debug",!1),a.environment.set("console.verbose",2),a.environment.set("console.minimum","log"),a.environment.set("ajax.cache",!1),a.isString(a.url)&&a.url.length>0&&a.mem.set("app.url",a.url),function(){var b=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,c="undefined"!=typeof InstallTrigger,d=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,e=!!window.chrome&&!b,f=!1||!!document.documentMode,g="other";b?g="opera":c?g="firefox":d?g="safari":e?g="chrome":f&&(g="ie"),a.environment.set("browser",g)}(),function(){Handlebars.registerHelper("environment",function(b){return new Handlebars.SafeString(a.environment.get(b))})}(),function(a,b){"use strict";function c(a){return"opera"===a||"firefox"===a||"chrome"===a}function d(a){for(var b=!1,c=0,d=p.length;d>c&&!b;++c)p[c].regex.test(a)&&(b=!0);return b}function e(a){var c=[];return b.each(p,function(b){var d=a.match(b.regex);d&&c.push({format:b,match:d})}),c=b.sortBy(c,function(a){return a.match.index})}function f(a){if(!b.isString(a))return[a];var c,f,g;for(g=[];d(a);)f=e(a),c=f[0],a=a.replace(c.format.regex,c.format.replacer),g=g.concat(c.format.styles(c.match));if(o>0)for(var h=0,i=o.length;i>h;++h)a="  "+a;return n?[a].concat(g):[a]}function g(a){var c=b.environment.get("console.minimum");switch(c){case"error":if("error"!==a)return!1;break;case"warning":case"warn":if("warn"!==a&&"warning"!==a&&"error"!==a)return!1;break;case"info":if("log"===a)return!1}return!0}function h(a,c){var d="console.verbose",e=b.environment.get(d),f=b.environment.get(d+"-"+a);return null===e&&null===f?!0:a&&null!==f?f>=c:e>=c}function i(c){if(!b.isNone(a.console)&&b.isFunction(a.console.log)&&"group"!==c.type){var d=a.console[c.type],e=c.source;b.isNone(d)&&(d=a.console.log),g(c.type)&&h(e,c.verbose)&&(1===c.args.length?d.apply(a.console,f(c.args[0])):d.apply(a.console,c.args))}}function j(a,b,c){var d="",e="color:white;",f="firefox"===m?"padding:3px;":"padding:1px;";switch(a){case"log":d+='[c="'+f+"background:#2d89ef;"+e+'"]   LOG   [c]';break;case"info":d+='[c="'+f+"background:#00a300;"+e+'"]  INFO.  [c]';break;case"warn":case"warning":d+='[c="'+f+"background:#ffc40d;"+e+'"]  WARN.  [c]';break;case"error":d+='[c="'+f+"background:#ee1111;"+e+'"]  ERROR  [c]'}return b&&(d+='[c="'+f+"background:#666;"+e+'"]  '+b+"  [c]"),d+='[c="background:inherits;color:inherits;"] [c]'+c}function k(a,c){var d=1,e="";if(c.length>0&&b.isTrueObject(c[0])&&c[0].storm===!0){d=parseInt(c[0].verbose,10),e=c[0].source;var f=j(a,e,c[0].value);c=[f]}var g={type:a,verbose:d,source:e,args:c};for(this.logs.push(g);this.logs.length>2e3;)this.logs.shift();this.isDirect&&i(g)}var l=!1,m=b.environment.get("browser"),n=c(m),o=0;a.console&&(b.isFunction(a.console.groupCollapsed)||(a.console.groupCollapsed=function(){a.console.log(arguments),o+=1}),b.isFunction(a.console.group)||(a.console.group=function(){a.console.log(arguments),o+=1}),b.isFunction(a.console.groupEnd)||(a.console.groupEnd=function(){o-=1}));var p=[{regex:/\*\*([^\*]+)\*\*/,replacer:function(a,b){return n?"%c"+b+"%c":b},styles:function(){return["font-weight: bold",""]}},{regex:/\_\_([^\_]+)\_\_/,replacer:function(a,b){return n?"%c"+b+"%c":b},styles:function(){return["font-style: italic",""]}},{regex:/\`\`\`([^\`]+)\`\`\`/,replacer:function(a,b){return n?"%c"+b+"%c":b},styles:function(){return["background: rgb(255, 255, 219); padding: 1px 5px; border: 1px solid rgba(0, 0, 0, 0.1)",""]}},{regex:/\[c\=(?:\"|\')?((?:(?!(?:\"|\')\]).)*)(?:\"|\')?\]((?:(?!\[c\]).)*)\[c\]/,replacer:function(a,b,c){return n?"%c"+c+"%c":c},styles:function(a){return[a[1],""]}}];b["debugger"]=function(a,b,c){this.name=a,this.collapsed=b||!1,this.parent=c||null,this.logs=[],this.isDirect=!0},b["debugger"].prototype={group:function(a,c){if(this.isDirect)return null;var d=new b["debugger"](a,c,this);return this.logs.push({type:"group",args:d}),d},print:function(){if(!this.isDirect){if(null===this.parent&&l===!0)return void setTimeout(this.print,50);var c=a.console;null===this.parent&&(l=!0),this.collapsed===!0?c.groupCollapsed(this.name):c.group(this.name),b.each(this.logs,function(a){if("group"===a.type){var b=a.args;b.print()}else i(a)}),c.groupEnd(),null==this.parent&&(l=!1)}},table:function(){k.call(this,"table",Array.prototype.slice.call(arguments))},log:function(){k.call(this,"log",Array.prototype.slice.call(arguments))},warn:function(){k.call(this,"warn",Array.prototype.slice.call(arguments))},info:function(){k.call(this,"info",Array.prototype.slice.call(arguments))},error:function(){k.call(this,"error",Array.prototype.slice.call(arguments))},storm:function(a,b,c,d){k.call(this,a,[{storm:!0,source:b||"",verbose:d||1,value:c||""}])},trace:function(a){return b.isString(a)?b.filter(this.logs,function(b){return b.type===a}):this.logs},clear:function(){this.logs=[]}}}(window,window.appstorm),function(a,b){b.console=new b["debugger"]("console",!0,null),b.console.isDirect=!0}(window,window.appstorm),a.eventEmitter=function(a){this.eventList={},this.eventBaseName=a},a.eventEmitter.prototype={clearEventType:function(){for(var a in this.eventList)(!this.eventList[a]||this.eventList[a].length<1)&&delete this.eventList[a]},bind:function(b,c,d,e,f){if(!b||!a.isString(b)){var g="The type ```"+b+"``` cannot be bind";return void a.console.storm("warn",this.eventBaseName+".bind",g,1)}if(!a.isFunction(c)){var g="unable to bind function, ```"+c+"``` is not a function";return void a.console.storm("warn",this.eventBaseName+".bind",g,1)}e!==!0&&(e=!1),f!==!1&&(f=!0),a.isUndefined(this.eventList[b])&&(this.eventList[b]=[]),this.eventList[b].push({fct:c,scope:d||null,once:e,clear:f}),this.dispatch(this.eventBaseName+".add",{type:b,fct:c})},bindOnce:function(a,b,c,d){this.bind(a,b,c,!0,d)},unbind:function(b,c){if(!b||!a.isString(b)){var d="The type ```"+b+"``` cannot be unbind";return void a.console.storm("warn",this.eventBaseName+".unbind",d,1)}var e=this.eventList[b];if(!a.isNone(e)){var f=e.length;if(a.isFunction(c))for(;f--;)e[f].fct===c&&e.splice(f,1);this.dispatch(this.eventBaseName+".unbind",{type:b,fct:c}),this.clearEventType()}},unbindAll:function(b){if(!a.isNone(this.eventList[b]))for(var c=this.eventList[b],d=c.length;d--;)c[d].clear===!0&&c.splice(d,1);this.clearEventType()},clear:function(){var a=this.eventBaseName+".clear";for(var b in this.eventList)b!==a&&this.unbindAll(b);this.dispatch(a,{})},dispatch:function(b,c){var d=this.eventList[b];if(!a.isNone(d))for(var e=0,f=d.length;f>e;++e)!function(a,b){setTimeout(function(){a.call(b,c)},0)}(d[e].fct,d[e].scope)}},a.message=new a.eventEmitter("a.message"),function(){function b(a,b){setTimeout(function(){b?a.call(b):a()},0)}var c=!1,d=[];a.message.bind("ready",function(){c=!0;for(var a=d.length;a--;)b(d[a].func,d[a].scope);d=null}),a.on=function(e,f,g){var h=e.toLowerCase();"ready"===h&&a.isFunction(f)?c===!0?b(f,g):d.push({func:f,scope:g}):a.message.bind(e,f,g)}}(),a.isNone(JSON)&&(a.isNone(JSON.parser)||a.isNone(JSON.stringify))&&!function(){function a(a){var b,c,h,j="json"==a;if(j||"json-stringify"==a||"json-parse"==a){if("json-stringify"==a||j){if(b="function"==typeof i.stringify&&z){(h=function(){return 1}).toJSON=h;try{b="0"===i.stringify(0)&&"0"===i.stringify(new Number)&&'""'==i.stringify(new String)&&i.stringify(g)===d&&i.stringify(d)===d&&i.stringify()===d&&"1"===i.stringify(h)&&"[1]"==i.stringify([h])&&"[null]"==i.stringify([d])&&"null"==i.stringify(f)&&"[null,null,null]"==i.stringify([d,g,f])&&'{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==i.stringify({A:[h,e,!1,f,"\x00\b\n\f\r	"]})&&"1"===i.stringify(f,h)&&"[\n 1,\n 2\n]"==i.stringify([1,2],f,1)&&'"-271821-04-20T00:00:00.000Z"'==i.stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i.stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i.stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i.stringify(new Date(-1))}catch(k){b=!1}}if(!j)return b}if("json-parse"==a||j){if("function"==typeof i.parse)try{if(0===i.parse("0")&&!i.parse(!1)&&(h=i.parse('{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'),c=5==h.a.length&&1==h.a[0])){try{c=!i.parse('"	"')}catch(l){}if(c)try{c=1!=i.parse("01")}catch(m){}}}catch(n){c=!1}if(!j)return c}return b&&c}}var b,c,d=void 0,e=!0,f=null,g={}.toString,h="function"==typeof define&&define.c,i=!h&&"object"==typeof exports&&exports;i||h?"object"==typeof JSON&&JSON?h?i=JSON:(i.stringify=JSON.stringify,i.parse=JSON.parse):h&&(i=this.JSON={}):i=this.JSON||(this.JSON={});var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=new Date(-0xc782b5b800cec);try{z=-109252==z.getUTCFullYear()&&0===z.getUTCMonth()&&1==z.getUTCDate()&&10==z.getUTCHours()&&37==z.getUTCMinutes()&&6==z.getUTCSeconds()&&708==z.getUTCMilliseconds()}catch(A){}a("json")||(z||(w=Math.floor,x=[0,31,59,90,120,151,181,212,243,273,304,334],y=function(a,b){return x[b]+365*(a-1970)+w((a-1969+(b=+(b>1)))/4)-w((a-1901+b)/100)+w((a-1601+b)/400)}),(b={}.hasOwnProperty)||(b=function(a){var c,d={};return(d.__proto__=f,d.__proto__={toString:1},d).toString!=g?b=function(a){var b=this.__proto__,a=a in(this.__proto__=f,this);return this.__proto__=b,a}:(c=d.constructor,b=function(a){var b=(this.constructor||c).prototype;return a in this&&!(a in b&&this[a]===b[a])}),d=f,b.call(this,a)}),c=function(a,c){var d,e,h,i=0;(d=function(){this.valueOf=0}).prototype.valueOf=0,e=new d;for(h in e)b.call(e,h)&&i++;d=e=f,i?i=2==i?function(a,c){var d,e={},f="[object Function]"==g.call(a);for(d in a)!(f&&"prototype"==d)&&!b.call(e,d)&&(e[d]=1)&&b.call(a,d)&&c(d)}:function(a,c){var d,e,f="[object Function]"==g.call(a);for(d in a)!(f&&"prototype"==d)&&b.call(a,d)&&!(e="constructor"===d)&&c(d);(e||b.call(a,d="constructor"))&&c(d)}:(e=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],i=function(a,c){var d,f="[object Function]"==g.call(a);for(d in a)!(f&&"prototype"==d)&&b.call(a,d)&&c(d);for(f=e.length;d=e[--f];b.call(a,d)&&c(d));}),i(a,c)},a("json-stringify")||(j={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},k=function(a,b){return("000000"+(b||0)).slice(-a)},l=function(a){for(var b,c='"',d=0;b=a.charAt(d);d++)c+='\\"\b\f\n\r	'.indexOf(b)>-1?j[b]:j[b]=" ">b?"\\u00"+k(2,b.charCodeAt(0).toString(16)):b;return c+'"'},m=function(a,h,i,j,n,o,p){var q,r,s,t,u,v,x,z,A,B=h[a];if("object"==typeof B&&B)if(q=g.call(B),"[object Date]"!=q||b.call(B,"toJSON"))"function"==typeof B.toJSON&&("[object Number]"!=q&&"[object String]"!=q&&"[object Array]"!=q||b.call(B,"toJSON"))&&(B=B.toJSON(a));else if(B>-1/0&&1/0>B){if(y){for(s=w(B/864e5),q=w(s/365.2425)+1970-1;y(q+1,0)<=s;q++);for(r=w((s-y(q,0))/30.42);y(q,r+1)<=s;r++);s=1+s-y(q,r),t=(B%864e5+864e5)%864e5,u=w(t/36e5)%24,v=w(t/6e4)%60,x=w(t/1e3)%60,t%=1e3}else q=B.getUTCFullYear(),r=B.getUTCMonth(),s=B.getUTCDate(),u=B.getUTCHours(),v=B.getUTCMinutes(),x=B.getUTCSeconds(),t=B.getUTCMilliseconds();B=(0>=q||q>=1e4?(0>q?"-":"+")+k(6,0>q?-q:q):k(4,q))+"-"+k(2,r+1)+"-"+k(2,s)+"T"+k(2,u)+":"+k(2,v)+":"+k(2,x)+"."+k(3,t)+"Z"}else B=f;if(i&&(B=i.call(h,a,B)),B===f)return"null";if(q=g.call(B),"[object Boolean]"==q)return""+B;if("[object Number]"==q)return B>-1/0&&1/0>B?""+B:"null";if("[object String]"==q)return l(B);if("object"==typeof B){for(a=p.length;a--;)if(p[a]===B)throw TypeError();if(p.push(B),z=[],h=o,o+=n,"[object Array]"==q){for(r=0,a=B.length;a>r;A||(A=e),r++)q=m(r,B,i,j,n,o,p),z.push(q===d?"null":q);a=A?n?"[\n"+o+z.join(",\n"+o)+"\n"+h+"]":"["+z.join(",")+"]":"[]"}else c(j||B,function(a){var b=m(a,B,i,j,n,o,p);b!==d&&z.push(l(a)+":"+(n?" ":"")+b),A||(A=e)}),a=A?n?"{\n"+o+z.join(",\n"+o)+"\n"+h+"}":"{"+z.join(",")+"}":"{}";return p.pop(),a}},i.stringify=function(a,b,c){var d,e,f,h,i,j;if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==g.call(b))e=b;else if("[object Array]"==g.call(b))for(f={},h=0,i=b.length;i>h;j=b[h++],("[object String]"==g.call(j)||"[object Number]"==g.call(j))&&(f[j]=1));if(c)if("[object Number]"==g.call(c)){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else"[object String]"==g.call(c)&&(d=c.length<=10?c:c.slice(0,10));return m("",(j={},j[""]=a,j),e,f,d,"",[])}),a("json-parse")||(n=String.fromCharCode,o={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"	",n:"\n",f:"\f",r:"\r"},p=function(){throw u=v=f,SyntaxError()},q=function(){for(var a,b,c,d,g,h=v,i=h.length;i>u;)if(a=h.charAt(u),"	\r\n ".indexOf(a)>-1)u++;else{if("{}[]:,".indexOf(a)>-1)return u++,a;if('"'==a){for(b="@",u++;i>u;)if(a=h.charAt(u)," ">a)p();else if("\\"==a)if(a=h.charAt(++u),'\\"/btnfr'.indexOf(a)>-1)b+=o[a],u++;else if("u"==a){for(c=++u,d=u+4;d>u;u++)a=h.charAt(u),a>="0"&&"9">=a||a>="a"&&"f">=a||a>="A"&&"F">=a||p();b+=n("0x"+h.slice(c,u))}else p();else{if('"'==a)break;b+=a,u++}if('"'==h.charAt(u))return u++,b}else{if(c=u,"-"==a&&(g=e,a=h.charAt(++u)),a>="0"&&"9">=a){for("0"==a&&(a=h.charAt(u+1),a>="0"&&"9">=a)&&p();i>u&&(a=h.charAt(u),a>="0"&&"9">=a);u++);if("."==h.charAt(u)){for(d=++u;i>d&&(a=h.charAt(d),a>="0"&&"9">=a);d++);d==u&&p(),u=d}if(a=h.charAt(u),"e"==a||"E"==a){for(a=h.charAt(++u),("+"==a||"-"==a)&&u++,d=u;i>d&&(a=h.charAt(d),a>="0"&&"9">=a);d++);d==u&&p(),u=d}return+h.slice(c,u)}if(g&&p(),"true"==h.slice(u,u+4))return u+=4,e;if("false"==h.slice(u,u+5))return u+=5,!1;if("null"==h.slice(u,u+4))return u+=4,f}p()}return"$"},r=function(a){var b,c;if("$"==a&&p(),"string"==typeof a){if("@"==a.charAt(0))return a.slice(1);if("["==a){for(b=[];a=q(),"]"!=a;c||(c=e))c&&(","==a?(a=q(),"]"==a&&p()):p()),","==a&&p(),b.push(r(a));return b}if("{"==a){for(b={};a=q(),"}"!=a;c||(c=e))c&&(","==a?(a=q(),"}"==a&&p()):p()),(","==a||"string"!=typeof a||"@"!=a.charAt(0)||":"!=q())&&p(),b[a.slice(1)]=r(q());return b}p()}return a},t=function(a,b,c){c=s(a,b,c),c===d?delete a[b]:a[b]=c},s=function(a,b,d){var e,f=a[b];if("object"==typeof f&&f)if("[object Array]"==g.call(f))for(e=f.length;e--;)t(f,e,d);else c(f,function(a){t(f,a,d)});return d.call(a,b,f)},i.parse=function(a,b){var c,d;return u=0,v=a,c=r(q()),"$"!=q()&&p(),u=v=f,b&&"[object Function]"==g.call(b)?s((d={},d[""]=c,d),"",b):c})),h&&define(function(){return i})}(),a.parser={json:{stringify:function(){try{return JSON.stringify.apply(null,arguments)}catch(b){var c="Unable to stringify the value ```"+arguments.toString()+"```. Below the stack trace.";return a.console.storm("error","a.parser.json.stringify",c,1),a.environment.get("app.debug")&&a.console.error(a.getStackTrace()),""}},parse:function(b){try{return JSON.parse(b)}catch(c){var d="Unable to parse the value ```"+b+"```. Below the stack trace.";return a.console.storm("error","a.parser.json.parse",d,1),a.environment.get("app.debug")&&a.console.error(a.getStackTrace()),null}}},xml:{stringify:function(b){if(!a.isNone(b)&&!a.isNone(b.xml))return b.xml;if(!a.isNone(window.XMLSerializer))try{var c=new window.XMLSerializer;return c.serializeToString(b)}catch(d){var e="Unable to stringify the value ```"+b+"```. Below the stack trace.";a.console.storm("error","a.parser.xml.stringify",e,1),a.environment.get("app.debug")&&a.console.error(a.getStackTrace())}return a.console.storm("error","a.parser.xml.stringify","Unable to find any parser for stringify xml...",1),""},parse:function(b){if(!a.isNone(window.ActiveXObject)){for(var c=null,d=0;4>d;++d)try{var e="MSXML2.DOMDocument."+(6-d)+".0";c=new ActiveXObject(e[d])}catch(f){}if(c.async=!1,c.loadXML(b),0!=c.parseError.errorCode){var g="Unable to parse the value ```"+b+"```, reason ```"+c.parseError.reason+"```. Below the stack trace.";return a.console.storm("error","a.parser.xml.parse",g,1),a.environment.get("app.debug")&&a.console.error(a.getStackTrace()),null}return c}return a.isNone(window.DOMParser)?(a.console.storm("error","a.parser.xml.parse","Unable to find any parser for parsing xml...",1),null):(new DOMParser).parseFromString(b,"text/xml")}}},a.timer=function(){"use strict";function b(){a.message.dispatch("a.timer.tick");for(var b in d){var e=d[b];e.current+=c,e.current>=e.timeout&&(e.current=0,a.isFunction(e.fct)&&e.fct.call(e.scope||this))}}var c=50,d={};return setInterval(b,c),{add:function(b,c,e){var f=a.uniqueId();return(!a.isNumber(e)||0>=e)&&(e=1e3,a.console.storm("warn","a.timer.add","The timeout has not been setted properly , timeout has been rollback to ```1000ms``` value",1)),d[f]={fct:b,scope:c,timeout:e,current:0},f},once:function(b,c,d){var e=this.add(function(){a.isFunction(b)&&b.call(this),a.timer.remove(e)},c,d);return e},get:function(b){var c=d[b];return a.isNone(c)?null:c},remove:function(a){return delete d[a]},clear:function(){d={}}}}(),!document.all||"querySelectorAll"in document||window.jQuery||!function(a,b){a=document,b=a.createStyleSheet(),a.querySelectorAll=function(c,d,e,f,g){for(g=a.all,d=[],c=c.replace(/\[for\b/gi,"[htmlFor").split(","),e=c.length;e--;){for(b.addRule(c[e],"k:v"),f=g.length;f--;)g[f].currentStyle.k&&d.push(g[f]);b.removeRule(0)}return d}}(),a.dom={query:function(b,c){return c=a.dom.el(c).get(0)||document,this.el(!c.querySelectorAll&&window.jQuery?jQuery(b):c.querySelectorAll(b))},el:function(b){if(b instanceof a.dom.children)return b;if(a.isString(b)){b=a.trim(b);var c=/^[a-zA-Z0-9 _-]+$/i;return c.test(b)?this.id(b):this.query(b)}if(window.jQuery&&b instanceof jQuery){for(var d=[],e=b.size();e--;)d.push(b.get(e));b=d}return b instanceof window.NodeList&&(b=a.toArray(b)),new this.children(a.isArray(b)?b:[b])},id:function(a){return this.attr("id",a,document)},cls:function(a,b){return this.attr("class",a,b)},tag:function(b,c){c=a.isTrueObject(c)?c:document;var d=a.isString(b)?b.replace(/ /g,"").split(","):b,e=[],f=d.length;if(f>1){for(;f--;){var g=this.tag(d[f],c),h=g.getElements();a.each(h,function(b){a.contains(e,b)||e.push(b)})}return new a.dom.children(e)}return e=c.querySelectorAll?c.querySelectorAll(b):c.getElementsByTagName(b),new a.dom.children(e)},attr:function(b,c,d){function e(b){return a.isString(b)?b.replace(/ /g,"").split(","):b}function f(b,c){a.each(c,function(c){a.contains(b,c)||b.push(c)})}if(a.isNone(d)){if(a.isNone(c)&&(c=document),a.isTrueObject(c)&&!a.isArray(c))return this.attr(b,null,c);d=document}if(b&&(a.isArray(b)||b.indexOf(",")>=0)){var g=e(b),h=g.length;if(h>1){for(var i=[];h--;){var j=this.attr(g[h],c,d),k=j.getElements();f(i,k)}return new a.dom.children(i)}}if(c&&(a.isArray(c)||c.indexOf(",")>0)){var l=e(c),h=l.length;if(h>1){for(var i=[];h--;){var j=this.attr(b,l[h],d),k=j.getElements();f(i,k)}return new a.dom.children(i)}}var m=a.isString(c),i=[];if(b=b.replace(/ /g,""),m&&(c=c.replace(/ /g,"")),"class"==b)i=d.getElementsByClassName(c);else if("id"==b)i=[d.getElementById(c)],a.isNull(i[0])&&i.pop();else if(d.querySelectorAll){var n=m?"["+b+'="'+c+'"]':"["+b+"]";i=d.querySelectorAll(n)}else for(var o=d.getElementsByTagName("*"),h=o.length;h--;){var p=o[h],q=p.getAttribute(b);q&&(m&&q==c||!m)&&(a.contains(i,p)||i.push(p))}return new a.dom.children(i)}},a.dom.event=function(a){a=a||window.event,this.target=a.target||a.srcElement,this.currentTarget=a.currentTarget||null,this.type=a.type,this._e=a,this.event=a,this.originalEvent=a},a.dom.event.prototype={stopPropagation:function(){var a=this.originalEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(){var a=this.originalEvent;a.preventDefault&&a.preventDefault(),a.returnValue=!1}},a.dom.eventBinder=function(b,c){return function(d){a.isFunction(b)&&(a.isObject(c)?b.call(c,new a.dom.event(d)):b.call(null,new a.dom.event(d)))}},a.dom.eventListener=new function(){function b(b,c,d,e){var f=new a.dom.eventBinder(d,e||null);return j.push({el:b,type:c,fn:d,bn:f}),f}function c(a,b,c){for(var d=j,e=d.length,f=null;e--;){var g=d[e];if(g.fn===c&&g.el===a&&g.type===b){f=g.bn,d.splice(e,1);break}}return f}function d(a,c,d,e){a.addEventListener(c,b(a,c,d,e),!1)}function e(a,b,d){a.removeEventListener(b,c(a,b,d),!1)}function f(a,c,d,e){a.attachEvent("on"+c,b(a,c,d,e))}function g(a,b,d){a.detachEvent("on"+b,c(a,b,d))}function h(a,c,d,e){a["on"+c]=b(a,c,d,e)}function i(a,b,d){c(a,b,d),a["on"+b]=null}var j=[];a.isFunction(window.addEventListener)?(this.bind=d,this.unbind=e):a.isFunction(document.attachEvent)?(this.bind=f,this.unbind=g):(this.bind=h,this.unbind=i)},a.dom.children=function(b){b=a.isUndefined(b.length)?[b]:b,this.elementList=b,this.length=b.length},a.dom.children.prototype={_perform:function(){var b=[],c=this.elementList,d=a.toArray(arguments),e=d[0],f=d.slice(1),g=f.length,h=c.length;for(f.push(null);h--;){f[g]=c[h];for(var i=e.apply(a.dom,f),j=i.getElements(),k=j.length;k--;)a.contains(b,j[k])||b.push(j[k])}return this.elementList=b,this.length=b.length,this},get:function(a){return this.elementList[a]||null},getElements:function(){return this.elementList},id:function(b){return this._perform(a.dom.id,b)},cls:function(b){return this._perform(a.dom.cls,b)},css:function(b,c){if(b=b||"",b.indexOf("-")>=0){for(var d=b.split("-"),e=1,f=d.length;f>e;++e){var g=d[e];d[e]=a.firstLetterUppercase(g)}b=d.join("")}if(a.isUndefined(c)){for(var h=[],i=this.elementList,e=i.length;e--;){var j=i[e].style[b];a.isNone(j)||h.push(j)}return h.length<=1?h[0]||"":h}this.each(function(){this.style[b]=c})},addClass:function(a){var b=new RegExp("(\\s|^)"+a+"(\\s|$)");return this.each(function(){this.classList?this.classList.add(a):this.className.match(b)||(this.className+=" "+a)}),this},hasClass:function(a){for(var b=new RegExp("(\\s|^)"+a+"(\\s|$)"),c=this.elementList,d=c.length;d--;)if(!c[d].className.match(b))return!1;return!0},removeClass:function(a){return this.each(function(b){if(this.classList)this.classList.remove(a);else{var c=new RegExp("(\\s|^)"+a+"(\\s|$)");this.className.match(c)&&this.className.replace(c,"")}},this),this},toggleClass:function(a){return this.each(function(b){if(this.classList)this.classList.toggle(a);else{var c=new RegExp("(\\s|^)"+a+"(\\s|$)");this.className.match(c)?this.className.replace(c,""):this.className+=" "+a}},this),this},bind:function(b,c,d){var e=a.isString(b)?b.split(" "):b;for(i=e.length;i--;)e[i]&&""!=e[i]&&this.each(function(b){a.dom.eventListener.bind(this,b,c,d)},e[i].toLowerCase());return this},unbind:function(b,c){var d=a.isString(b)?b.split(" "):b;for(i=d.length;i--;)d[i]&&""!=d[i]&&this.each(function(b){a.dom.eventListener.unbind(this,b,c)},d[i].toLowerCase());return this},tag:function(b){return this._perform(a.dom.tag,b)},attr:function(b,c){return this._perform(a.dom.attr,b,c)},attribute:function(b,c){var d=a.isString(b)?b.replace(/ /g,"").split(","):b;if(a.isUndefined(c)){for(var e=[],f=this.elementList,g=f.length;g--;){var h=f[g];a.each(d,function(b){try{var c=h.getAttribute(b);a.isNone(c)||a.contains(e,c)||e.push(c)}catch(d){}})}return e.length<2?e.join(""):e}return this.each(function(){a.each(d,function(a){try{this.setAttribute(a,c)}catch(b){}},this)}),this},data:function(a,b){return this.attribute("data-"+a,b)},appstorm:function(a,b){return this.attribute("data-"+a+",a-"+a+","+a,b)},parent:function(){var b=this.elementList,c=[];return a.each(b,function(b){var d=b.parentNode;a.contains(c,d)||c.push(d)}),this.elementList=c,this.length=c.length,this},children:function(b){var c=this.elementList,d=[],e=c.length;for(b=b||[1];e--;)d.push(a.toArray(c[e].childNodes));var f=a.remove(a.uniq(a.flatten(d)),function(c){return a.contains(b,c.nodeType)?!0:!1});return this.elementList=f,this.length=f.length,this},all:function(){for(var b=this.elementList,c=[],d=b.length;d--;)c.push(a.toArray(b[d].getElementsByTagName("*")));var e=a.remove(a.uniq(a.flatten(c)),function(a){return 3==a.nodeType?!1:!0});return this.elementList=e,this.length=e.length,this},insertBefore:function(b){var c=a.dom.el(b),d=c.getElements();return this.each(function(){a.each(d,function(a){this.parentNode.insertBefore(a,this)},this)}),this},insertAfter:function(b){var c=a.dom.el(b),d=c.getElements();return this.each(function(){a.each(d,function(a){this.parentNode.insertBefore(a,this.nextSibling)},this)}),this},empty:function(){return this.each(function(){for(;this.firstChild;)this.removeChild(this.firstChild)}),this},remove:function(b){var c=a.dom.el(b),d=c.getElements();return this.each(function(){a.each(d,function(a){try{this.removeChild(a)}catch(b){}},this)}),this},append:function(b){var c=a.dom.el(b),d=c.getElements();return this.each(function(){a.each(d,function(a){this.appendChild(a)},this)}),this},replace:function(a){return this.empty(),this.append(a)},html:function(b){if(a.isUndefined(b)){var c=[];return this.each(function(){c.push(this.innerHTML)}),0===c.length?"":1===c.length?c[0]:c}return this.each(function(){this.innerHTML=b}),this},each:function(){var b=this.elementList,c=a.toArray(arguments),d=c[0],e=c.slice(1);return d=a.isFunction(d)?d:function(){},a.each(b,function(a){d.apply(a,e)}),this}},a.hash=new function(){function b(){var a=window.location.hash;return a?a.substring(1):null}function c(a){for(h.set("current",a),f.push({hash:a,time:(new Date).getTime()});f.length>500;)f.shift()}function d(d){var f=null;if(d&&d.originalEvent&&d.originalEvent.newURL){var i=d.originalEvent.newURL;f=i.substring(i.indexOf("#")+1)}else f=b();if(e!=f){c(f);var j={value:f,old:e};g.dispatch("change",j),a.message.dispatch("a.hash.change",j),e=f,h.set("previous",e)}}var e=null,f=[],g=this,h=a.mem.getInstance("app.hash");h.set("history",f),a.on("ready",function(){d()}),"onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7)?a.dom.eventListener.bind(window,"hashchange",d,null):a.timer.add(d,null,50),this.fake=function(b){if(e!=b){c(b);var d={value:b,old:e};g.dispatch("change",d),a.message.dispatch("a.hash.change",d)}e=b,h.set("previous",e)},this.getHash=function(){return b()},this.get=function(){return b()},this.getPreviousHash=function(){return e},this.setPreviousHash=function(a){e=a,h.set("previous",e)},this.trace=function(){return f}},a.hash=a.extend(a.hash,new a.eventEmitter("a.hash")),function(a){function b(b,c,d){if(a.isNone(c)||a.isArray(c)&&0===c.length)return a.model.pooler.createInstance(b);for(var e={},f=0,g=c.length;g>f;++f){var h=d[c[f]];h&&(e[c[f]]=h)}e.modelName=b;var i=a.model.pooler.searchInstance(e);return i.length>0?i[0]:a.model.pooler.createInstance(b)}var c={add:function(b,c,d,e){0>=e&&(e=1e3);var f=a.uniqueId(),g={id:f,method:b.toUpperCase(),url:c,results:d};a.mem.set("app.ajax.cache."+g.id,g),setTimeout(a.scope(function(){a.mem.remove("app.ajax.cache."+this.id)},g),e)},get:function(b,c){if(!b||!c)return null;b=b.toUpperCase();var d=a.mem.getInstance("app.ajax.cache"),e=d.list();for(var f in e){var g=e[f];if(g.method===b&&g.url===c)return g.results}return null}};a.ajax=function(b,c,d){"use strict";var e=[a.getDefaultAjaxOptions()];if(a.isString(b.template)&&b.template&&(b.template=[b.template]),a.isArray(b.template))for(var f=0,g=b.template.length;g>f;++f){var h=a.getTemplateAjaxOptions(b.template[f]);a.isTrueObject(h)&&e.push(h)}this.params={before:[],url:"",method:"GET",type:"raw",async:!0,cache:!1,store:"",data:{},header:{},many:!1,model:"",after:[]},a.environment.get("ajax.cache")===!0&&(this.params.cache=!0);for(var i in this.params)if("data"!==i&&"header"!==i){for(var f=0,g=e.length;g>f;++f){var h=e[f];i in h&&typeof h[i]==typeof this.params[i]&&(a.isArray(h[i])?this.params[i]=a.union(this.params[i],h[i]):this.params[i]=h[i])}i in b&&typeof b[i]==typeof this.params[i]&&(this.params[i]=b[i])}for(var f=0,g=e.length;g>f;++f){var h=e[f];if(a.isTrueObject(h.data))for(var j in h.data)this.params.data[j]=h.data[j];if(a.isTrueObject(h.header))for(var k in h.header)this.params.header[k]=h.header[k]}if(a.isString(b.data))this.params.data=b.data;else if(a.isTrueObject(b.data))for(var l in b.data)this.params.data[l]=b.data[l];if(a.isTrueObject(b.header))for(var m in b.header)this.params.header[m]=b.header[m];if(this.success=a.isFunction(c)?c:function(){},this.error=a.isFunction(d)?d:function(){},this.request=null,a.isNone(window.XMLHttpRequest))for(var n=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],f=0,g=n.length;g>f;++f)try{this.request=new ActiveXObject(n[f])}catch(o){}else this.request=new XMLHttpRequest},a.ajax.prototype.parseResult=function(d,e){if(204===e.status)return"";var f=d.type.toLowerCase(),g="json"===f?a.parser.json.parse(e.responseText):"xml"===f?e.responseXML:e.responseText;if(d.model){var h=d.model,i="Model "+h+" not found, empty object recieve Model Pooler",j=a.model.pooler.getPrimary(h);if(null===j)a.console.storm("error","a.ajax",i,1);else if(d.many===!0&&a.isArray(g)){for(var k=[],l=0,m=g.length;m>l;++l){var n=g[l],o=b(h,j,n);null!==o?(o.fromObject(n),
k.push(o)):a.console.storm("error","a.ajax",i,1)}g=k}else{var o=b(h,j,g);o?(o.fromObject(g),g=o):a.console.storm("error","a.ajax",i,1)}}if("after"in d)for(var l=0,m=d.after.length;m>l;++l){var p=a.getAjaxAfter(d.after[l]);a.isFunction(p)&&(g=p.call(this,d,g))}if("store"in d&&d.store){var q=d.store,r=1;q.indexOf("min")>0?r=6e4:q.indexOf("h")>0?r=36e5:q.indexOf("s")>0&&(r=1e3),c.add(d.method,d.url,g,r*parseInt(d.store,10))}return g},a.ajax.prototype.abort=function(){try{this.request.abort()}catch(a){}},a.ajax.prototype.send=function(){var b=this.params.method.toUpperCase(),d=a.mock.get(b,this.params.url);if(null!==d){var e=this.params;return a.message.dispatch("a.ajax",{success:!0,status:200,url:e.url,method:b,params:e}),void this.success(d,200)}if(a.isArray(this.params.before))for(var f=this.params.before,g=0,h=f.length;h>g;++g){var i=a.getAjaxBefore(f[g]);a.isFunction(i)&&(this.params=i.call(this,this.params))}var j=c.get(this.params.method||"GET",this.params.url||"");if(j)return void this.success(j,200);if(this.params.cache===!1){var k=a.uniqueId("rnd_");try{this.params.data.cachedisable=k}catch(l){}}var m="";if(a.isString(this.params.data))m=this.params.data;else{for(var n in this.params.data)m+=encodeURIComponent(n)+"="+encodeURIComponent(this.params.data[n])+"&";m=m.slice(0,-1)}var o=this.params.url,p=this.params.async;if("GET"==b&&m&&(o+="?"+m),p===!0){var q={success:this.success,params:this.params,error:this.error,request:this.request,parseResult:this.parseResult};this.request.onreadystatechange=function(){var b=-1;try{b=q.request.status}catch(c){return}if(4===q.request.readyState){var d=b>=200&&400>b||0===b||1223===b;1223===b&&(b=204),d?q.success(q.parseResult(q.params,q.request),b):q.error(o,b),a.message.dispatch("a.ajax",{success:d,status:b,url:q.params.url,method:q.method,params:q.params})}}}this.request.open(b,o,p);var r=["Content-Type","Content-type","content-type"],s=!1;for(var t in this.params.header)this.request.setRequestHeader(t,this.params.header[t]),!s&&a.contains(r,t)&&(s=!0);if(s||"POST"!==b||this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d=a.mock.get(b,this.params.url),null!==d){var e=this.params;return a.message.dispatch("a.ajax",{success:!0,status:200,url:e.url,method:b,params:e}),void this.success(d,200)}return this.request.send(m),p===!1?this.parseResult(this.params,this.request):"No return in async mode"},a.setTemplateAjaxOptions("json",{type:"json",header:{"Content-Type":"application/json",Accept:"application/json"}}),a.setTemplateAjaxOptions("xml",{type:"xml",header:{"Content-Type":"application/xml",Accept:"application/xml"}}),a.setTemplateAjaxOptions("list",{many:!0}),a.setTemplateAjaxOptions("array",{many:!0}),a.setTemplateAjaxOptions("many",{many:!0}),a.setTemplateAjaxOptions("cache-enable",{cache:!0}),a.setTemplateAjaxOptions("cache-disable",{cache:!1});for(var d=["POST","PUT","GET","DELETE","HEAD","OPTIONS","CONNECT","TRACE","PATCH"],e=0,f=d.length;f>e;++e)!function(b){a.setTemplateAjaxOptions(b,{method:b})}(d[e])}(window.appstorm),a.loader=function(){"use strict";function b(b,c){if(a.isNone(b))return!1;for(var d=0,e=f.length;e>d;++d)if(f[d]===b)return a.isFunction(c)&&c(),!0;return!1}function c(b,c){(a.isNone(c)||c.cache!==!1)&&f.push(b)}function d(b,d,e,f,h,i){for(var j in d)b.setAttribute(j,d[j]);!a.isNone(h)&&h.id&&b.setAttribute("id",h.id);var k=!1,l=function(d){k||(k=!0,a.isFunction(e)&&e(b),c(f,h))};if(b.addEventListener?b.addEventListener("load",l,!1):b.readyState?b.onreadystatechange=function(){("complete"==this.readyState||"loaded"==this.readyState)&&l()}:b.onload=l,"text/css"===d.type){var m=document.styleSheets.length;g++;var n=a.timer.add(function(){document.styleSheets.length>m+g-1&&(g--,a.timer.remove(n),l())},null,50)}document.getElementsByTagName("head")[0].appendChild(b)}function e(b,d,e,f){var g={url:b,method:"GET",type:"raw",async:!0,cache:!0,data:{},header:{}};a.console.storm("log","a.loader","Loading resource from url ```"+b+"```",3),a.isNone(e)||(a.contains(h,e.method)&&(g.method=e.method),a.isNone(e.type)||"json"!=e.type&&"xml"!=e.type||(g.type=e.type),a.isTrueObject(e.data)&&(g.data=e.data),a.isTrueObject(e.header)&&(g.header=e.header),a.isBoolean(e.cache)&&(g.cache=e.cache));var i=function(f,g){a.isFunction(d)&&d(f,g),c(b,e)},j=a.isFunction(f)?f:function(){};new a.ajax(g,i,j).send()}var f=[],g=0,h=["GET","POST","PUT","DELETE","HEAD","OPTIONS"];return{js:function(a,c,d,e){b(a,c)||this.jsonp(a,c,d,e)},jsonp:function(b,c,e,f){var g=a.isTrueObject(e)&&e.type?e.type:"text/javascript";a.console.storm("log","a.loader","Loading resource from url ```"+b+"```",3),d(document.createElement("script"),{type:g,src:b},c,b,e,f)},json:function(b,c,d,f){a.isTrueObject(d)||(d={}),d.type="json",a.isTrueObject(d.header)||(d.header={}),d.header.accept="application/json, text/javascript",e(b,c,d,f)},xml:function(b,c,d,f){a.isTrueObject(d)||(d={}),d.type="xml",a.isTrueObject(d.header)||(d.header={}),d.header.accept="application/xml, text/xml",e(b,c,d,f)},css:function(c,e,f,g){b(c,e)||(a.console.storm("log","a.loader","Loading resource from url ```"+c+"```",3),d(document.createElement("link"),{rel:"stylesheet",type:"text/css",href:c},e,c,f,g))},html:function(c,d,f,g){b(c,d)||(a.isTrueObject(f)||(f={}),f.type="raw",a.environment.get("app.debug")===!0&&(f.cache=!1),a.isTrueObject(f.header)||(f.header={}),f.header.accept="text/html",e(c,d,f,g))},javafx:function(c,d,e,f){if(a.isNone(e)||a.isNone(e.code)||a.isNone(e.id)){var f="The system need args.code ";return f+="and args.name setted to be able to load any ",f+="javafx resource... This uri will not be ",f+="loaded ```"+c+"```",void a.console.storm("warn","a.loader.javafx",f,2)}if(!b(c,d)){var g=e.version?e.version:"1.3";this.js("http://dl.javafx.com/"+g+"/dtfx.js",function(){javafx({archive:c,width:e.width||1,height:e.height||1,code:e.code,name:e.id})});var h=null,i=2e3;h=a.timer.add(function(){i-->0&&!a.isNone(document.getElementById(e.id).Packages)?(a.timer.remove(h),a.isFunction(d)&&d()):0>=i&&a.isFunction(f)&&f(c,408)},null,200)}},flash:function(c,d,e,f){if(a.isNone(e)||a.isNone(e.rootId)||a.isNone(e.id)){var f="The system need args ";return f+="parameters: rootId and id, setted to be able ",f+="to load any flash resource... This uri ",f+="will not be loaded ```"+c+"```",void a.console.storm("warn","a.loader.flash",f,2)}b(c,d)||this.js(a.url+"vendor/storage/flash/swfobject.js",function(){swfobject.embedSWF(c,e.rootId,"100%","100%","10.0.0",a.url+"vendor/storage/flash/expressInstall.swf",e.flashvars,e.params,{id:e.id},function(b){b.success===!1&&a.isFunction(f)?f(c,408):b.success===!0&&a.isFunction(d)&&setTimeout(d,500)})})},silverlight:function(c,d,e,f){if(a.isNone(e)||a.isNone(e.rootId)||a.isNone(e.id)){var f="The system need args ";return f+="parameters: rootId, id, setted to be able ",f+="to load any silverlight resource... This uri ",f+="will not be loaded ```"+c+"```",void a.console.storm("warn","a.loader.silverlight",f,2)}if(!b(c,d)){a.console.storm("log","a.loader","Loading resource from url ```"+c+"```",3);var g=document.createElement("object");g.id=e.id,g.data="data:application/x-silverlight-2,",g.type="application/x-silverlight-2",a.isArray(e.params)||(e.params=[]),e.params.push({name:"source",value:c});for(var h=0,i=e.params.length;i>h;++h){var j=document.createElement("param");j.name=e.params[h].name,j.value=e.params[h].value,g.appendChild(j)}document.getElementById(e.rootId).appendChild(g);var k=null,l=2e3;k=a.timer.add(function(){l-->0&&!a.isNone(document.getElementById(e.id).Content)?(a.timer.remove(k),d()):0>=l&&a.isFunction(f)&&f(c,408)},null,200)}},trace:function(){return f}}}(),a.route=new function(){function b(a){return"leave"==a||"leaving"==a?"leave":"enter"}function c(a,b){var c=d.get(b+".hash")||{},e=c[a]||[],f=e.length;for(found=!1;f--;)found=!0,function(b){setTimeout(function(){var c=e[b];c.call(null,a)},0)}(f);if(!found){var g=d.get(b+".otherwise");g&&g.call(null,a)}}var d=a.mem.getInstance("app.route");this.bind=function(a,c,e){e=b(e)+".hash";var f=d.get(e)||{};return f[a]||(f[a]=[]),f[a].push(c),d.set(e,f),this},this.unbind=function(c,e,f){f=b(f)+".hash";var g=d.get(f)||{};return g[c]&&(g[c]=a.without(g[c],e),g[c].length<1&&delete g[c],d.set(f,g)),this},this.otherwise=function(c,e){return e=b(e)+".otherwise",a.isNone(c)?d.remove(e):d.set(e,c),this},this.go=function(b,c){c&&a.state.inject(c),b&&(window.location.href="#"+b)},this.href=this.go,this.ref=this.go,this.hash=this.go,this.hashtag=this.go,this.navigate=this.go,this.fake=function(b,c){c&&a.state.inject(c),b&&a.hash.fake(b)},this.back=function(){window.history.back()},a.hash.bind("change",function(a){c(a.value,"enter"),c(a.old,"leave")},null,!1,!1)},a.parameter={_fct:{},extract:function(b,c){var d=/\{\{(\s*[a-zA-Z0-9-\--_]+\s*:\s*[a-z0-9_\-\[\]\(\)\^.\|\+\*\?\\\/]+\s*)\}\}/gim,e=!a.isNone(c);e&&(d=c);for(var f,g=[];f=d.exec(b);){var h=null;h=e?["hash",f[1]]:f[1].split(":",2),g.push({original:a.trim(f[0]),name:a.trim(h[0]),regex:a.trim(h[1]),start:f.index})}return g},replace:function(b,c,d){return a.isNone(d)&&(d="("+c.regex+")"),b.substr(0,c.start)+d+b.substr(c.start+c.original.length)},convert:function(a,b){for(var c=this.extract(a,b),d=c.length;d--;)a=this.replace(a,c[d]);return a},getValues:function(a,b,c){for(var d=c.length,e=""+b;d--;)e=this.replace(e,c[d]);for(var f=new RegExp("^"+e+"$","gi"),g=f.exec(a),h=1,i=g.length;i>h;++h)c[h-1].value=g[h];return c},extrapolate:function(b,c,d,e){if(e!==!1&&(e=!0),a.isString(b)&&b&&b.indexOf("{{")>=0&&b.indexOf("}}")>=0){var f=/\{\{(\s*\w+\s*)\}\}/gim,g=this.extract(b),h=this.extract(d),i=this.extract(b,f);g=g.concat(i);for(var j=h.length;j--;)d=this.replace(d,h[j]);var k=new RegExp("^"+d+"$","gi"),l=k.exec(c);if(l){for(var m=0,n=h.length;n>m;++m)h[m].value=l[m+1];for(var o=0,p=g.length;p>o;++o)for(m=0;n>m;++m)h[m].name===g[o].regex&&"hash"===g[o].name&&(g[o].value=h[m].value)}for(var q=g.length,r=e===!1?function(a,b,c){return c}:this.replace;q--;){var s=g[q],t=!1;if("hash"!==s.name&&"hashtag"!==s.name||a.isNone(s.value)||(t=!0,b=this.replace(b,s,s.value)),!t){var u=this._fct;a.each(u,function(a,c){c==s.name&&(b=r(b,s,a(s.regex)))})}}}return b},addParameterType:function(b,c){b&&a.isString(b)&&a.isFunction(c)&&(this._fct[b]=c)},removeParameterType:function(a){delete this._fct[a]}},function(){a.parameter.addParameterType("mem",a.mem.get),a.parameter.addParameterType("environment",a.environment.get)}(),a.acl=a.extend(new function(){var b=a.mem.getInstance("app.acl");this.setCurrentRole=function(c){b.set("current",c),this.dispatch("change",c),a.message.dispatch("a.acl.change",c)},this.getCurrentRole=function(){return b.get("current")||""},this.setRoleList=function(c){a.isArray(c)&&(b.set("list",c),a.each(c,function(b){var c=a.firstLetterUppercase(b,"is"),d=b.toLowerCase();Handlebars.registerHelper(c,function(b,c){return a.trim(b.toLowerCase())===a.trim(d)?c.fn(this):c.inverse(this)})}))},this.getRoleList=function(){return b.get("list")},this.isAllowed=function(a,b){b=b||this.getCurrentRole();for(var c=-1,d=-1,e=this.getRoleList()||[],f=e.length;f--&&(e[f]==a&&(d=f),e[f]==b&&(c=f),-1==d||-1==c););return c>=d},this.isRefused=function(a,b){return!this.isAllowed(a,b)},this.clear=function(){b.clear()}},new a.eventEmitter("a.acl")),function(){Handlebars.registerHelper("AclRole",function(b){return new Handlebars.SafeString(a.acl.getCurrentRole())}),Handlebars.registerHelper("AclIsAllowed",function(b,c,d){return d=a.isString(c)?d:c,c=a.isString(c)?c:a.acl.getCurrentRole(),a.acl.isAllowed(b,c)?d.fn(this):d.inverse(this)}),Handlebars.registerHelper("AclIsRefused",function(b,c,d){return d=a.isString(c)?d:c,c=a.isString(c)?c:a.acl.getCurrentRole(),a.acl.isAllowed(b,c)?d.inverse(this):d.fn(this)})}(),a.mock={_mock:[],clear:function(){a.mock._mock=[]},add:function(b,c,d,e){var f=a.mock._mock;b||(b="get"),f.push({method:b.toLowerCase(),url:c,result:d||{},model:e||null})},get:function(b,c){for(var d=a.mock._mock,e=d.length;e--;){var f=d[e];if(f.method===b.toLowerCase()&&f.url===c)return a.isFunction(f.result)?f.result():f.result}return null},merge:function(b){if(!b)return{};for(var c={},d=a.mock._mock,e=d.length;e--;){var f=d[e];if(f.model)if(f.model===b){var g=a.isFunction(f.result)?f.result():f.result;c=a.assign(c,g)}else if(f.model===b+"s")for(var g=a.isFunction(f.result)?f.result():f.result,h=g.length;h--;)c=a.assign(c,g[h])}for(var h in c){var i=c[h];a.isString(i)?c[h]="string":a.isBoolean(i)?c[h]="boolean":a.isNumber(i)&&!a.isNaN(i)?c[h]="number":a.isArray(i)?c[h]="array":a.isTrueObject(i)?c[h]="object":c[h]="UNKNOW"}return c},map:function(){for(var b={},c=a.mock._mock,d=c.length;d--;){var e=c[d];if(e.model){var f=e.model,g=e.method;b[f]||(b[f]={}),b[f][g]||(b[f][g]=[]),b[f][g].push(e.url)}else{var h="unknow";b[h]||(b[h]={}),b[h][g]||(b[h][g]=[]),b[h][g].push(e.url)}}return b}},a.keyboard=function(b){"use strict";function c(){e.clear(),b.reset()}function d(a){return function(b){for(var c=e.get(a)||[],d=c.length,f={stopPropagation:function(){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},preventDefault:function(){b.preventDefault?b.preventDefault():b.returnValue=!1},_e:b,event:b,originalEvent:b},g=!0;d--;){var h=c[d].fct,i=c[d].scope,j=h.call(i,f);j===!1&&(g=!1)}return g}}var e=a.mem.getInstance("app.accelerator");if(a.isNone(b)){a.console.storm("error","a.keyboard","Mousetrap is undefined!",1);var f=function(){};return{bind:f,unbind:f,reset:f,clear:f}}return{bind:function(c,f,g,h){if(c&&a.isFunction(f)){h=a.isString(h)&&h?h:"keypress";var i=h+"."+c,j=e.get(i)||[];if(j.push({fct:f,scope:g||b}),e.set(i,j),1==j.length){var k=d(i);b.bind(c,k,h)}}},unbind:function(c,d,f){if(a.isFunction(d)){f=a.isString(f)&&f?f:"keypress";var g=f+"."+c,h=e.get(g)||[];if(h){for(var i=h.length;i--;)h[i].fct===d&&h.splice(i,1);0==h.length&&(e.remove(g),b.unbind(c,f))}}},trigger:function(a,c){b.trigger(a,c)},reset:c,clear:c}}(window.Mousetrap),a.callback={},a.callback.synchronizer=function(b,c,d){return a.extend(new a.callback.synchronizerInstance(b,c,d),new a.eventEmitter("a.callback.synchronizer"))},a.callback.synchronizerInstance=function(a,b,c){this.callbacks=a||[],this.successFunction=b,this.errorFunction=c,this.data={},this.resultScope=null,this.scope=null,this.parrallelCount=0,this.running=!1},a.callback.synchronizerInstance.prototype={addCallback:function(){var b=a.toArray(arguments);if(this.callbacks=this.callbacks.concat(b),this.isRunning()){var c=this.scope||this,d=this.getResultObject();a.each(b,function(a){a.call(c,d)})}},removeCallback:function(b){this.callbacks=a.without(this.callbacks,b)},setScope:function(b){a.isTrueObject(b)&&(this.scope=b)},getData:function(a){return this.data[a]||null},setData:function(b,c){a.isNone(c)?delete this.data[b]:this.data[b]=c},getResultObject:function(){var b=a.scope(this.next,this),c=a.scope(this.stop,this);return{next:b,done:b,success:b,fail:c,error:c,stop:c,setData:a.scope(this.setData,this),getData:a.scope(this.getData,this)}},next:function(){if(this.parrallelCount--,0==this.parrallelCount&&this.running&&(this.running=!1,this.dispatch("success"),a.isFunction(this.successFunction))){var b=this.resultScope||this.scope||this;this.successFunction.call(b,this.getResultObject())}},stop:function(){this.parrallelCount=0;var b=this.running;this.running=!1;var c=this.resultScope||this.scope||this,d=a.toArray(arguments);this.dispatch("error"),b&&a.isFunction(this.errorFunction)&&(d.push(this.getResultObject()),this.errorFunction.apply(c,d))},start:function(){if(this.parrallelCount=this.callbacks.length,this.running=!0,this.dispatch("start"),this.parrallelCount<=0)return this.parrallelCount=1,void this.next();var b=this.scope||this,c=a.toArray(arguments);c.push(this.getResultObject());for(var d=0,e=this.callbacks.length;e>d;++d){var f=this.callbacks[d];f.apply(b,c)}},isRunning:function(){return this.running}},a.callback.synchronizerInstance.prototype.success=a.callback.synchronizerInstance.prototype.next,a.callback.synchronizerInstance.prototype.done=a.callback.synchronizerInstance.prototype.next,a.callback.synchronizerInstance.prototype.fail=a.callback.synchronizerInstance.prototype.stop,a.callback.synchronizerInstance.prototype.error=a.callback.synchronizerInstance.prototype.stop,a.callback.chainer=function(b,c,d){return a.extend(new a.callback.chainerInstance(b,c,d),new a.eventEmitter("a.callback.chainer"))},a.callback.chainerInstance=function(a,b,c){this.callbacks=a||[],this.queue=[],this.successFunction=b,this.errorFunction=c,this.data={},this.resultScope=null,this.scope=null},a.callback.chainerInstance.prototype={addCallback:function(){var b=a.toArray(arguments);this.callbacks=this.callbacks.concat(b),this.isRunning()&&(this.queue=this.queue.concat(b))},removeCallback:function(b){this.callbacks=a.without(this.callbacks,b),this.queue=a.without(this.without,b)},setScope:function(b){a.isTrueObject(b)&&(this.scope=b)},getData:function(a){return this.data[a]||null},setData:function(b,c){a.isNone(c)?delete this.data[b]:this.data[b]=c},getResultObject:function(){return{next:a.scope(this.next,this),done:a.scope(this.next,this),success:a.scope(this.next,this),fail:a.scope(this.stop,this),error:a.scope(this.stop,this),stop:a.scope(this.stop,this),setData:a.scope(this.setData,this),getData:a.scope(this.getData,this)}},next:function(){var b=a.toArray(arguments),c=this.scope||this;if(b.push(this.getResultObject()),!this.queue.length)return this.dispatch("success"),void(a.isFunction(this.successFunction)&&(c=this.resultScope||c,this.successFunction.apply(c,b)));var d=this.queue.shift();a.isFunction(d)&&d.apply(c,b)},stop:function(){this.queue=[];var b=this.scope||this,c=a.toArray(arguments);this.dispatch("stop"),a.isFunction(this.errorFunction)&&(c.push(this.getResultObject()),this.errorFunction.apply(b,c))},start:function(){this.queue.length||(this.queue=a.deepClone(this.callbacks),this.dispatch("start"),this.next())},isRunning:function(){return this.queue.length?!0:!1}},a.callback.chainerInstance.prototype.success=a.callback.chainerInstance.prototype.next,a.callback.chainerInstance.prototype.done=a.callback.chainerInstance.prototype.next,a.callback.chainerInstance.prototype.fail=a.callback.chainerInstance.prototype.stop,a.callback.chainerInstance.prototype.error=a.callback.chainerInstance.prototype.stop,a.storage={debugGet:function(b,c,d){"_support_t"!==c&&a.console.storm("log","a.storage.type."+b+".get","Get the element ```"+c+"``` with value ```"+d+"```",3)},printError:function(b,c){"_support_t"!==c&&a.console.storm("log","a.storage.type."+b+".get","Unable to find the key ```"+c+"``` in store...",3)},debugSet:function(b,c,d){"_support_t"!==c&&a.console.storm("log","a.storage.type."+b+".set","Add the element key ```"+c+"``` with value ```"+d+"```",3)},debugRemove:function(b,c){"_support_t"!==c&&a.console.storm("log","a.storage.type."+b+".remove","Remove the element ```"+c+"```",3)},type:{}},a.storage.type.cookie=new function(){var b=!1;this.support=!1,this.engine="cookie",this.set=function(b,c,d){var e="";if(a.storage.debugSet("cookie",b,c),d){var f=new Date;f.setTime(f.getTime()+24*d*60*60*1e3),e="; expires="+f.toGMTString()}var g=b+"="+escape(a.parser.json.stringify(c));g+=e+"; path=/",document.cookie=g},this.get=function(b){if(document.cookie.length>0){var c=document.cookie.indexOf(b+"=");if(-1!=c){c=c+b.length+1;var d=document.cookie.indexOf(";",c);-1==d&&(d=document.cookie.length);var e=a.parser.json.parse(unescape(document.cookie.substring(c,d)));return a.storage.debugGet("cookie",b,e),e}}return a.storage.printError("cookie",b),null},this.remove=function(b){a.storage.debugRemove("cookie",b),this.set(b,"",-1)};var c="_support_t";this.set(c,"o"),"o"==this.get(c)&&(this.remove(c),this.support=!0),b=!0},a.storage.cookie=a.storage.type.cookie,a.storage.type.localStorage=new function(){var b=!1,c="_support_t",d="localStorage";if(d in window&&null!=window[d])try{window.localStorage.setItem(c,"o"),"o"==window.localStorage.getItem(c)&&(window.localStorage.removeItem(c),b=!0)}catch(e){b=!1}this.support=b,this.engine=d,this.get=function(c){if(b){var d=window.localStorage.getItem(c);if(a.isNone(d))return a.storage.printError(this.engine,c),null;var e=a.parser.json.parse(d);return a.storage.debugGet(this.engine,c,e),e}return null},this.set=function(c,d){b&&(a.storage.debugSet(this.engine,c,d),window.localStorage.setItem(c,a.parser.json.stringify(d)))},this.remove=function(c){b&&(a.storage.debugRemove(this.engine,c),window.localStorage.removeItem(c))}},a.storage.type.globalStorage=new function(){var b=!1,c="_support_t",d=window.location.hostname;if(!a.isNone(window.globalStorage))try{window.globalStorage[d].setItem(c,"o"),"o"==window.globalStorage[d].getItem(c)&&(window.globalStorage[d].removeItem(c),b=!0)}catch(e){b=!1}this.support=b,this.engine="globalStorage",this.get=function(c){if(b){var e=window.globalStorage[d].getItem(c);if(a.isTrueObject(e)&&!a.isNone(e.value)){var f=a.parser.json.parse(e.value);return a.storage.debugGet(this.engine,c,f),f}if(a.isNone(e))return a.storage.printError(this.engine,c),null;var f=a.parser.json.parse(e);return a.storage.debugGet(this.engine,c,f),f}return null},this.set=function(c,e){b&&(a.storage.debugSet(this.engine,c,e),window.globalStorage[d].setItem(c,a.parser.json.stringify(e)))},this.remove=function(c){b&&(a.storage.debugRemove(this.engine,c),window.globalStorage[d].removeItem(c))}},a.storage.type.memory=new function(){var b=a.mem.getInstance("app.storage");this.support=!0,this.engine="memory",this.get=b.get,this.set=b.set,this.remove=b.remove},a.storage.memory=a.storage.type.memory,a.storage.type.sessionStorage=new function(){var b=!1,c="_support_t",d="sessionStorage";if(d in window&&!a.isNone(window[d]))try{window.sessionStorage.setItem(c,"o"),"o"==window.sessionStorage.getItem(c)&&(window.sessionStorage.removeItem(c),b=!0)}catch(e){b=!1}this.support=b,this.engine=d,this.get=function(c){if(b){var d=window.sessionStorage.getItem(c);if(a.isNone(d))return a.storage.printError(this.engine,c),null;var e=a.parser.json.parse(d);return a.storage.debugGet(this.engine,c,e),e}return null},this.set=function(c,d){b&&(a.storage.debugSet(this.engine,c,d),window.sessionStorage.setItem(c,a.parser.json.stringify(d)))},this.remove=function(c){b&&(a.storage.debugRemove(this.engine,c),window.sessionStorage.removeItem(c))}},a.storage.type.userData=new function(){var b=!1,c="_support_t",d="a_storage",e="aUserDataStorage";if(document.all)try{document.write('<input type="hidden" id="'+d+'" style="display:none;behavior:url(\'#default#userData\')" />');var f=document.getElementById(d);f.load(e),f.setAttribute(c,"o"),f.save(e),"o"==f.getAttribute(c)&&(f.removeAttribute(c),f.save(e),b=!0)}catch(g){b=!1}this.support=b,this.engine="userData",this.get=function(c){if(b){var d=a.parser.json.parse(f.getAttribute(c));return a.isNone(d)?(a.storage.printError(this.engine,c),null):(a.storage.debugGet(this.engine,c,d),d)}return null},this.set=function(c,d){b&&(a.storage.debugSet(this.engine,c,d),f.setAttribute(c,a.parser.json.stringify(d)),f.save(e))},this.remove=function(c){b&&(a.storage.debugRemove(this.engine,c),f.removeAttribute(c),f.save(e))}},a.storage.type.flash=new function(){function b(b){if(0==c&&0==d){var f=document.createElement("div");f.id="flashstoragecontent",document.body.appendChild(f);var g={id:e,rootId:f.id,flashvars:{},params:{wmode:"transparent",menu:"false",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always"}};a.loader.flash(a.url+"vendor/storage/flash/localStorage.swf",function(e){d=!0;var f=document.getElementById(g.id);1==f.testData()&&(c=!0,f.setDatabase("a_flashStorage")),1==c&&a.isFunction(b)&&b(c)},g)}else 1==c&&a.isFunction(b)&&b(c)}var c=!1,d=!1,e="flashstorage";this.support=function(){return c},this.ready=function(){return d},this.engine="flash",this.start=function(a){b(a)},this.get=function(b){if(this.start(),1==c){var d=document.getElementById(e).getData(b);return a.isNone(d)?(a.storage.printError(this.engine,b),null):(a.storage.debugGet(this.engine,b,d),d)}return null},this.set=function(b,d){this.start(),1==c&&(a.storage.debugSet(this.engine,b,d),document.getElementById(e).setData(b,d))},this.remove=function(b){return this.start(),1==c?(a.storage.debugRemove(this.engine,b),document.getElementById(e).removeData(b)):void 0}},a.storage.type.silverlight=new function(){function b(b){if(0==c&&0==d){var f=document.createElement("div");f.id="_silverlightstorage",document.body.appendChild(f);var g={id:e,rootId:f.id,params:[{name:"minRuntimeVersion",value:"2.0.31005.0"},{name:"autoUpgrade",value:"true"}]};a.loader.silverlight(a.url+"vendor/storage/silverlight/silverlightStorage.xap",function(e){d=!0;var f=document.getElementById(g.id);1==f.Content.store.testData()&&(c=!0),1==c&&a.isFunction(b)&&b(c)},g)}else 1==c&&a.isFunction(b)&&b(c)}var c=!1,d=!1,e="silverlightstorage";this.support=function(){return c},this.ready=function(){return d},this.engine="silverlight",this.start=function(a){b(a)},this.get=function(b){if(this.start(),1==c){var d=document.getElementById(e).Content.store.loadData(b);if(a.isNone(d)||"false"===d)return a.storage.printError(this.engine,b),null;var f=a.parser.json.parse(d);return a.storage.debugGet(this.engine,b,f),f}return null},this.set=function(b,d){this.start(),1==c&&(a.storage.debugSet(this.engine,b,d),document.getElementById(e).Content.store.saveData(b,a.parser.json.stringify(d)))},this.remove=function(b){this.start(),1==c&&(a.storage.debugRemove(this.engine,b),document.getElementById(e).Content.store.removeData(b))}},a.storage.type.javafx=new function(){function b(b){if(0==c&&0==d){var f={code:"javafxstorage.Main",id:e};a.loader.javafx(a.url+"vendor/storage/javafx/JavaFXStorage.jar",function(){d=!0;var f=document.getElementById(e);1==f.Packages.javafxstorage.localStorage.testData()&&(c=!0,el.setDatabase("a_javafxStorage")),1==c&&a.isFunction(b)&&b(c)},f)}else 1==c&&a.isFunction(b)&&b(c)}var c=!1,d=!1,e="javafxstorage";this.support=function(){return c},this.ready=function(){return d},this.engine="javafx",this.start=function(a){b(a)},this.get=function(b){if(this.start(),1==c){var d=document.getElementById(e).Packages.javafxstorage.localStorage.loadData(b);if(a.isNone(d)||"false"===d)return a.storage.printError(this.engine,b),null;var f=a.parser.json.parse(d);return a.storage.debugGet(this.engine,b,f),f}return null},this.set=function(b,d){this.start(),1==c&&(a.storage.debugSet(this.engine,b,d),document.getElementById(e).Packages.javafxstorage.localStorage.saveData(b,a.parser.json.stringify(d)))},this.remove=function(b){this.start(),1==c&&(a.storage.debugRemove(this.engine,b),document.getElementById(e).Packages.javafxstorage.localStorage.removeData(b))}},a.storage.temporary=function(){"use strict";for(var b=["sessionStorage","cookie","memory"],c=0,d=b.length;d>c;++c){var e=b[c];if(a.storage.type[e].support)return a.console.storm("info","a.storage.temporary","Choosing the storage ```"+a.storage.type[e].engine+"```",3),a.message.dispatch("a.storage.temporary.change",{engine:e}),a.storage.type[e]}return null}(),a.storage.external=function(){"use strict";function b(b,c){a.storage.external.ready=b.ready,a.storage.external.support=b.support,a.storage.external.engine=b.engine,a.storage.external.get=b.get,a.storage.external.set=b.set,a.storage.external.remove=b.remove,a.isFunction(c)&&c()}return{start:function(c){var d=a.storage.type.silverlight,e=a.storage.type.flash,f=a.storage.type.javafx,g="a.storage.external",h="Choosing the storage ";d.start(function(i){i?(a.console.storm("info",g,h+"silverlight",3),b(d,c)):e.start(function(d){d?(a.console.storm("info",g,h+"flash",3),b(e,c)):f.start(function(d){d?(a.console.storm("info",g,h+"javafx",3),b(f,c)):a.console.storm("info",g,h+"NONE AVAILABLE",3)})})})}}}(),a.storage.persistent=function(){"use strict";for(var b=["localStorage","globalStorage","userData","cookie"],c=0,d=b.length;d>c;++c){var e=b[c];if(a.storage.type[e].support)return a.console.storm("info","a.storage.persistent","Choosing the storage ```"+a.storage.type[e].engine+"```",3),a.message.dispatch("a.storage.persistent.change",{engine:e}),a.storage.type[e]}return null}(),null==a.storage.persistent&&(a.storage.persistent={},a.storage.persistent.support=!1,a.storage.persistent.engine=function(){return"none"},a.storage.persistent.get=function(){return null},a.storage.persistent.set=function(){},a.storage.persistent.remove=function(){}),a.storage.support=a.storage.persistent.support,a.storage.engine=a.storage.persistent.engine,a.storage.get=a.storage.persistent.get,a.storage.set=a.storage.persistent.set,a.storage.remove=a.storage.persistent.remove,function(){function b(b){var c=a.storage.temporary.get(b);return a.isNone(c)&&(c=a.storage.persistent.get(b)),c}function c(a){return new Handlebars.SafeString(b(a))}a.parameter.addParameterType("temporary",a.storage.temporary.get),a.parameter.addParameterType("memory",a.storage.memory.get),a.parameter.addParameterType("persistent",a.storage.persistent.get),a.parameter.addParameterType("cookie",a.storage.cookie.get),a.parameter.addParameterType("storage",b),a.parameter.addParameterType("store",b),Handlebars.registerHelper("temporary",function(b){return new Handlebars.SafeString(a.storage.temporary.get(b))}),Handlebars.registerHelper("memory",function(b){return new Handlebars.SafeString(a.storage.memory.get(b))}),Handlebars.registerHelper("persistent",function(b){return new Handlebars.SafeString(a.storage.persistent.get(b))}),Handlebars.registerHelper("cookie",function(b){return new Handlebars.SafeString(a.storage.cookie.get(b))}),Handlebars.registerHelper("storage",c),Handlebars.registerHelper("store",c)}(),a.translate=a.i18n=function(){"use strict";function b(a,b){return a.getAttribute(b)||a.getAttribute("a-"+b)||a.getAttribute("data-"+b)||""}function c(c,d){var e=b(c,r);if(e&&""!=e)try{c[e]=d}catch(f){}else if("INPUT"==c.nodeName){var g=c.type;if("submit"==g||"reset"==g||"button"==g)c.value=d;else try{c.placeholder=d}catch(f){}}else if("FIELDSET"===c.nodeName)c.title=d;else if(""!==b(c,s))a.dom.el(c).empty().append(document.createTextNode(d));else{for(var h=d.split("<tag>"),i=0,j=c.childNodes.length,k=h.length;j>i;++i){var l=c.childNodes[i];l&&3==l.nodeType&&l.parentNode.removeChild(l)}if(i=0,a.dom.el(c).children().each(function(){var a=h[i]||"",b=document.createTextNode(a);i++,this.parentNode.insertBefore(b,this)}),k>i)for(var m=k-i,m=0,n=k-i;n>m;++m)c.appendChild(document.createTextNode(h[i+m]))}}function d(d){d=d||document;var e=a.dom.el(d),f=q+",a-"+q+",data-"+q,g=o[n]||{},h=e.attr(f).getElements();d.getAttribute&&(d.getAttribute(q)||d.getAttribute("a-"+q)||d.getAttribute("data-"+q))&&h.push(d),a.dom.el(h).each(function(){var d=b(this,q),e=g[d]||"";""===e&&(e=d);for(var f=e.match(t),h=a.map(f,function(a){return a.replace("{{","").replace("}}","")}),i={},j=h.length;j--;){var l=h[j],m=q+"-"+l,n=b(this,m);n&&(i[l]=n)}var o=k(d,i,!0);c(this,o)})}function e(){return n}function f(b,c){a.isString(b)&&b?(n=b,u&&a.storage.persistent.set("app.language",n),c!==!1&&d()):(a.console.storm("error","a.translate.setLanguage","Setting a non-string lang, or empty string, as default translate: ","```"+b+"```. Cannot proceed",1),a.console.error(b))}function g(a){return p[a]||""}function h(a,b){p[a]=b}function i(b,c,e,f){return a.isTrueObject(c)?void a.each(c,function(a,c){i(b,c,a,f)}):(o[b]||(o[b]={}),o[b][c]=e,void(f!==!1&&d()))}function j(a,b,c){if(null===b)delete o[a];else for(var e in b)i(a,e,b[e],!1);c!==!1&&d()}function k(b,c,d){function e(a){for(var b=c,d=p,e=[b,d],f=0;2>f;++f)for(var g in e[f])if(a==="{{"+g+"}}")return e[f][g];return""}if(!o[n])return b;var f=o[n][b]||null;if(a.isNull(f))return b;if(d===!1)return f;for(var g=f.match(t)||[],h=0,i=g.length;i>h;++h){var j=g[h];f=f.replace(j,e(j))}return f.replace(t,"")}function l(a){return a?o[a]||{}:o}function m(){o={}}var n="en-US",o={},p={},q="tr",r="custom-tr",s="erase-tr",t=/\{\{[a-z0-9\-_]+\}\}/gi,u=a.storage&&a.storage.persistent.support;if(u){var v=a.storage.persistent.get("app.language");

a.isString(v)&&v.length>0&&(n=v,d())}return{getLanguage:e,getCurrent:e,setLanguage:f,setCurrent:f,translate:d,i18n:d,getDictionnary:l,getGlobalVariable:g,addGlobalVariable:h,setGlobalVariable:h,add:i,addTranslation:i,get:k,getTranslation:k,set:j,setTranslation:j,clear:m}}(),a.form=function(){"use strict";function b(b){var c=a.dom.el(b),d=c.data("name");return(a.isNone(d)||""==d)&&(d=c.attribute("name"),(a.isNone(d)||""===d)&&(d=c.attribute("id"),(a.isNone(d)||""===d)&&(d=c.attribute("class")))),d}function c(a){var b=a.type||"",c=a.tagName.toLowerCase();return"input"===c||"textarea"===c?"checkbox"===b?a.checked:a.value:"select"===c?a.options[a.selectedIndex]?a.options[a.selectedIndex].value:null:void 0}function d(a){for(var b=a.tag(["input","textarea","select"]).getElements(),c=b.length;c--;){var d=b[c];!d.type||"submit"!=d.type&&"button"!=d.type&&"reset"!=d.type&&"image"!=d.type||b.splice(c,1)}return b}function e(b,c,d,e){var f="";if(a.isNone(d)||""===d||(f=b["data-error-"+d]||null),(a.isNone(f)||""===f)&&(f=b["data-error"]||null),a.isNone(f)||""===f){var g="A data-error tag has not been setted for id ";g+="```"+c+"``` with value ```"+e+"```",g+=".Cannot proceed error message...",a.console.storm("warn","a.form",g,3)}return f=a.translate.get(f,{name:d,value:e}),{el:b,id:c,error:f}}function f(b){var c=a.model.manager.get(b);return c?c:a.model.pooler.createTemporaryInstance(b)}function g(b,c,d){var e=c.list(),f={};b=a.dom.el(b);var g=d.allowed,h=d.refused;a.isString(g)&&g&&(g=[g]),a.isString(h)&&h&&(h=[h]);var i=a.isArray(g),j=a.isArray(h);if(i||j)for(var k=e.length;k--;)j&&a.contains(h,e[k])?e.splice(k,1):i&&!a.contains(g,e[k])&&e.splice(k,1);var l=d.customize||d.custom||null;a.each(e,function(b){var d=c.type(b),e=null,g=c.get(b),h=null;switch(d){case"radio":break;case"checkbox":e="input",h=document.createElement("input"),h.type="checkbox";break;default:e="input",h=document.createElement("input"),h.type="text",null!==g&&(h.value=g)}if(l){if(l[b]){var i=l.property,j=i.call(null,h,b);a.isTrueObject(j)&&(h=j)}if(l[e]){var i=l[e],j=i.call(null,h,b);a.isTrueObject(j)&&(h=j)}if(l[d]){var i=l[d],j=i.call(null,h,b);a.isTrueObject(j)&&(h=j)}}f[b]=h}),d.label||d.showLabel;var m=d.placement;a.isArray(m)||a.each(f,function(a){b.append(a)})}{var h=["text","search","url","tel","email","password"],i=["number","range","date","datetime","datetime-local","month","time","week"],j=h.concat(i,["number","checkbox","radio","file"]);i.concat(h,["color","checkbox","file","hidden","radio"])}return{skipNoValidate:!1,get:function(e){e=a.dom.el(e);for(var f=d(e),g={},h=f.length;h--;){var i=f[h],j=a.trim(b(i)),k=c(i);if(!a.isNone(j)&&j){var l=!1;a.isNone(i)||"radio"!==i.type?a.isNone(i)||"checkbox"!==i.type?l=!0:(l=!1,g[j]=i.checked?!0:!1):i.checked&&(l=!0),l&&("[]"===j.substr(j.length-2)?(a.isArray(g[j])||(g[j]=[]),k=k?k:null,g[j].push(k)):g[j]=k?k:null)}}return g},validate:function(c){if(c=a.dom.el(c),this.skipNoValidate===!1&&!a.isNone(c.get(0).novalidate))return[];for(var f=d(c),g=[],k=["number","range","text","search","url","email","password","color","checkbox","hidden","radio"],l=new RegExp("^[a-z]{2,}:\\/\\/([a-z0-9\\/\\.\\-_~+;:&=]{2,})$","gi"),m=new RegExp("^.{2,}@.*\\.[a-z0-9]{2,}$","gi"),n=new RegExp("^#([a-f]{3}|[a-f]{6})$","gi"),o=f.length;o--;){var p=f[o],q=p.tagName.toLowerCase();if("select"!=q&&a.isNone(p.novalidate)){var r=p.type,s=b(p),t=p.value,u=p.required,v=p.pattern,w=(p.multiple,p.min),x=p.max,y=p.step;if(w=a.isNone(w)||""==w?null:parseFloat(w),x=a.isNone(x)||""==x?null:parseFloat(x),y=a.isNone(y)||""==y?null:parseFloat(y),"input"!=q||a.contains(k,r)||a.isNone(r))if("number"!=r&&"range"!=r||a.isNumber(t))if("url"!=r||l.test(t))if("email"!=r||m.test(t))if("color"!=r||n.test(t))if(null===u||!a.contains(j,r)||""!==t&&!a.isNone(t)){if(null!==v&&("textarea"===q||a.contains(h,r)||a.isNone(r))){var z=new RegExp(v);if(!z.test(t)){g.push(e(p,s,"pattern",t));continue}}if((null!==w||null!=x||null!=y)&&a.contains(i,r)){var A=parseFloat(t);if(null!==w&&w>A){g.push(e(p,s,"min",t));continue}if(null!==x&&A>x){g.push(e(p,s,"max",t));continue}if(null!==y&&A%y!==0){g.push(e(p,s,"step",t));continue}}}else g.push(e(p,s,"required",t));else g.push(e(p,s,null,t));else g.push(e(p,s,null,t));else g.push(e(p,s,null,t));else g.push(e(p,s,null,t));else{var B="Type ```"+r;B+="``` for input ```"+s+"```",B+="is not recognized and/or supported",a.console.storm("warn","a.form.validate",B,3)}}}return g},validateAndGet:function(a){var b={errorList:this.validate(a),error:!1,contentList:this.get(a)};return b.errorList.length>0&&(b.error=!0),b},model:function(b){b=a.dom.el(b),b.each(function(){var b=a.dom.el(this),c=b.data("model"),d=b.data("method"),e=b.data("form");if(c&&d){var h=f(c),i=(h.request(d),h.form(e));g(b,h,i)}})}}}(),a.state=new function(){function b(b,c){b||(a.console.storm("error","An error has occurs, with no state linked to it... Below the stack trace",1),a.console.error(a.getStackTrace()));b?b.id:null;c="_"+c;for(var d=[c,c.substring(0,c.length-1)+"x",c.substring(0,c.length-2)+"xx","generic","_generic"],e=0,f=d.length;f>e;++e)for(var g=b,h=d[e];!a.isNull(g);){if(!a.isNone(g.error)&&!a.isNone(g.error[h]))return g.error[h];g=g.parent||null}return null}function c(c,d){var e={},f=a.state._errorState,g=f?f.id:null;a.isNone(c)||(e.resource=c),a.isNone(d)||(e.status=d);var h=b(f,d),i="An error occurs, but no error function/hash inside the state can handle it. Please check your error handler for the state ```"+g+"```, HTTP status code ```"+d+"```, and resource ```"+c+"```";a.message.dispatch("a.state.error",e),h?a.isString(h)?window.location.href="#"+h:a.isFunction(h)?h(g,c,d):a.console.storm("error","a.state",i,1):a.console.storm("error","a.state",i,1)}function d(b,c,d,e,f){var g=a.state.chain.getWithTest(b,c),h=a.callback.chainer(g,d,e);h.scope=c,h.resultScope=f,h.start()}function e(b,c,e,f,g){var h=a.callback.synchronizer(null,e,f);a.each(c,function(c){h.addCallback(function(){d(b,c,a.scope(this.next,this),a.scope(this.error,this),h)})}),h.resultScope=g,h.start()}function f(a){for(var b=a.length;b--;)if(a[b]._storm.acl===!1)return!1;return!0}function g(a){for(var b=[a];a.parent;)b.push(a.parent),a=a.parent;return b}function h(b){var c=[];for(var d in o){var e=o[d];if(e._storm.hash&&a.isArray(e._storm.hash)){for(var h=[],i=0,j=e._storm.hash.length;j>i;++i){var k=e._storm.hash[i];if(k.isRegexHash){if(k.regex.lastIndex=0,k.regex.test(b)){h=g(e);break}}else if(k.hash==b){h=g(e);break}}f(h)?c.push(h):a.console.storm("log","a.state.foundHashState","Acl have been refused for state ```"+e.id+"```",3)}}return c}function i(b,d){var f=a.groupBy(b,function(a){return-a._storm.level}),g=a.callback.chainer(null,d,c);a.each(f,function(a){g.addCallback(function(){e("unload",a,this.next,this.error,g)})}),g.start()}function j(b,d){var f=a.groupBy(b,function(a){return a._storm.level}),g=a.callback.chainer(null,d,c);a.each(f,function(a){g.addCallback(function(){e("load",a,this.next,this.error,g)})}),g.start()}function k(a){for(var b=a.length;b--;){var c=a[b];("persistent"in c&&c.persistent===!0||"persist"in c&&c.persist===!0)&&a.splice(b,1)}return a}function l(b){a.message.dispatch("a.state.begin",b),a.state._errorState=null;var c=b.value,d=(b.old,h(c)),e=a.uniq(a.flatten(d)),f=p,g=a.difference(e,f),l=a.difference(f,e),m=[];a.each(d,function(b){if(b.length>0){var c=a.first(b);a.contains(f,c)&&!a.contains(l,c)&&m.push(b[0])}}),l=a.union(l,m),g=a.union(g,m),p=a.difference(p,l).concat(g),l=k(l),setTimeout(function(){i(l,function(){setTimeout(function(){j(g,function(){a.state._inject={},a.message.dispatch("a.state.end",b)})},0)})},0)}function m(b,c){if(!c||a.isNone(c))return!0;var d=b.acl||{};return a.isString(d.minimum)&&a.acl.isRefused(d.minimum,c)||a.isString(d.maximum)&&a.acl.isRefused(c,d.maximum)?!1:a.isString(d.allowed)&&d.allowed!==c||a.isArray(d.allowed)&&!a.contains(d.allowed,c)?!1:a.isString(d.refused)&&d.refused===c||a.isArray(d.refused)&&a.contains(d.refused,c)?!1:!0}function n(b){a.each(o,function(a){a._storm.acl=m(a,b)})}var o={},p=[];a.hash.bind("change",l,null,!1,!1),a.acl.bind("change",function(a){n(a)},null,!1,!1),this.add=function(b){if(a.isArray(b))return void a.each(b,function(a){this.add(a)},this);b.id&&null===this.get(b.id)||(b.id=a.uniqueId("state_"));var c=b.children||null;if(b.children=null,b._storm={parent:b.parent||null,options:b.options||null,data:b.data||{},flash:b.flash||null,level:0,acl:null},b.flash=a.scope(function(b){if(a.isString(this._storm.flash)&&this._storm.flash){var c=this.entry||this.target||this.el||this.dom||null;a.isFunction(c)&&(c=c.call(this)),c&&a.isString(c)?a.dom.query(this._storm.flash,c).html(b):a.dom.query(this._storm.flash).html(b)}else a.isFunction(this._storm.flash)?this._storm.flash.apply(this,arguments):this.parent&&a.isFunction(this.parent.flash)?this.parent.flash(b):a.console.storm("error","a.state","The state ```"+this.id+"``` was unable to proceed flash message ```"+this._storm.flash+"```",1)},b),b.parent&&(a.isString(b.parent)||a.isNumber(b.parent))){var d=this.get(b.parent);d?(b.parent=d,b._storm.level=d._storm.level+1,d.children&&a.isArray(d.children)||(d.children=[]),d.children.push(b)):a.console.storm("error","a.state.add","Unable to find the parent ```"+b.parent+"``` for state ```"+b.id+"```",1)}else b.parent=null;if(b.hash&&a.isString(b.hash)&&(b.hash=[b.hash]),b.hash&&a.isArray(b.hash)){b._storm.hash=[];for(var e=0,f=b.hash.length;f>e;++e){var g=b.hash[e],h=a.state.protocol.tester(g);if(h){var i=a.state.protocol.get(h);a.isTrueObject(i)&&(g=i.fn(b,e))}var j={isRegexHash:!1,regex:null,hash:a.parameter.convert(g)};g.indexOf("{{")>=0&&g.indexOf("}}")>=0&&(j.isRegexHash=!0),j.isRegexHash&&(j.hash="^"+j.hash+"$",j.regex=new RegExp(j.hash,"g")),b._storm.hash.push(j)}}b._storm.acl=m(b,a.acl.getCurrentRole()),b.data={},b.options=null,o[b.id]=b,a.isArray(c)?a.each(c,function(a){a.parent=b.id,this.add(a)},this):a.isTrueObject(c)&&(c.parent=b.id,this.add(c))},this.use=function(b,c){var d=this.get(b);d&&this.add(a.extend(a.deepClone(d),c))},this.extend=this.use,this.remove=function(b){var c=this.get(b);c&&a.isArray(c.children)&&a.each(c.children,function(a){this.remove(a)},this),delete o[b]},this.clear=function(){o={},p=[],this._errorState=null,this._inject={}},this.get=function(a){return o[a]||null},this.tree=function(){return o},this.load=function(b){var c=this.get(b);if(c){var d=g(c),e=a.difference(d,p);e.length<=0&&(e=[c]),p=p.concat(e),setTimeout(function(){j(e)},0)}},this.reload=function(b){var c=this.get(b);if(c){var d=g(c),e=a.difference(d,p);e.length<=0&&(e=[c]),p=p.concat(e),setTimeout(function(){i(e,function(){setTimeout(function(){j(e)},0)})},0)}},this.unload=function(a){var b=this.get(a);if(b){var c=g(b);i(c)}},this.__loaded=function(){return p},this.hashExists=function(b){var c=a.flatten(h(b));return c.length>0},this.inject=function(b){a.isNull(this._inject)&&(this._inject={}),a.isTrueObject(b)&&(this._inject=a.assign(this._inject,b))},this._errorState=null,this._inject={}},function(){Handlebars.registerHelper("inject",function(b){return new Handlebars.SafeString(a.state._inject[b]||null)}),a.parameter.addParameterType("inject",function(b){return a.state._inject[b]||null})}(),a.state.chain=new function(){function b(a){return 1==a||1==a||"loading"==a||"load"==a?c:d}var c=[],d=[];this.add=function(c,d,e,f,g){g=g||{};var h=b(c),i={name:d,test:e,fct:f,scope:g.scope||null},j=a.pluck(h,"name"),k=j.length;g.after&&a.contains(j,g.after)?k=a.indexOf(j,g.after)+1:g.before&&a.contains(j,g.before)?k=a.indexOf(j,g.before):g.position<=j.length&&(k=g.position),0>k&&(k=0),k>=j.length?h.push(i):h=h.splice(k,0,i)},this.remove=function(a,c){for(var d=b(a),e=d.length;e--;)d[e].name==c&&d.splice(e,1)},this.get=function(a){return b(a)},this.getWithTest=function(a,c){for(var d=b(a),e=[],f=0,g=d.length;g>f;++f){var h=d[f],i=h.test;i&&i.call(c,c)===!0&&e.push(h.fct)}return e}},function(){function b(){var b=a.toArray(arguments),c=a.last(b),d=a.initial(b);c.next.apply(this,d)}function c(){var b=this.entry||this.target||this.el||this.dom||null;return a.isFunction(b)?b.call(this):b}function d(b,c){return b===!0||b===c||a.isArray(b)&&a.contains(b,c)}function e(b){return a.isString(b)?[b]:a.isArray(b)?b:[]}function f(b,c,d){return function(e){a.loader[b](c,function(b){a.isFunction(d)&&d(b),e.next()},a.scope(e.error,this))}}function g(b,c,d){a.each(b,function(e,f){a.isTrueObject(e)?g(e,c,d):b[f]=a.parameter.extrapolate(e,c,d)})}function h(b,c,d,e,f,h){var i=a.isNone(c)?b._storm.data:b._storm.data[c],j=a.hash.getHash(),k=b.hash||[""],l=null;if(e=a.isTrueObject(e)?e:{},a.isString(d))for(var m=0,n=k.length;n>m;++m){var o=0===d.indexOf("{{")?!1:!0;l=a.parameter.extrapolate(d,j,k[m],o),g(e,j,k[m])}return function(g){var j=e.method?e.method:"GET",k=a.mock.get(j,d);if(null!==k)return a.isNone(c)?b.data=k:b.data[c]=k,void g.next();if(a.isString(i)&&0===i.indexOf("{{")&&i.indexOf("}}")===i.length-2)return a.isNone(c)?b.data=l:b.data[c]=l,void g.next();if(a.isFunction(i)){var m=function(d){a.isNone(c)?b.data=d:b.data[c]=d,g.next()},n={next:m,done:m,success:m,fail:g.fail,error:g.error,stop:g.stop,setData:g.setData,getData:g.getData};i.call(b,n)}else if(null!==l){e.url=l;var o=new a.ajax(e,function(d){a.isNone(c)?b.data=d:b.data[c]=d,a.isFunction(f)?f.call(b,d,g):g.next()},function(c,d){a.isFunction(h)?h.call(b,c,d,g):g.error.apply(b,arguments)});o.send()}else a.console.storm("error","a.state.chain","Request cannot be proceed, url parsing have fail. It can be  related to some missing parameters. Request: ```"+c+"```, state: ```"+b.id+"```",2)}}function i(b,c,d){for(var f=b.include||[],g=c+"_"+d,h=a.firstLetterUppercase(d,c),i=c+"_default",k=c+"Default",l=f[g]||f[h]||f[i]||f[k]||f[c]||[],m=e(l),n=j(b),o=m.length;o--;)for(var p=0,q=n.length;q>p;++p)m[o]=a.parameter.extrapolate(m[o],a.hash.getHash(),n[p]);return m}function j(b){for(var c=a.hash.getHash(),d=b.hash||[],e=[],f=0,g=d.length;g>f;++f){var h=b.hash[f],i=b._storm.hash[f];i.isRegexHash?(i.regex.lastIndex=0,i.regex.test(c)&&e.push(h)):h===c&&e.push(h)}return e}a.state.chain.add(!0,"loadParameters",function(){return"hash"in this&&!a.isNone(this.hash)},function(){try{for(var c={},d=j(this),e=a.hash.getHash(),f=0,g=d.length;g>f;++f)for(var h=a.parameter.extract(d[f]),i=a.parameter.getValues(e,d[f],h),k=i.length;k--;)c[i[k].name]=i[k].value;this.parameters=c}catch(l){}b.apply(this,arguments)}),a.state.chain.add(!0,"preLoad",function(){return a.isFunction(this.preLoad)},function(){return d(this.async,"preLoad")?void this.preLoad.apply(this,arguments):(this.preLoad.call(this),void b.apply(this,arguments))}),a.state.chain.add(!0,"title",function(){return"title"in this&&a.isString(this.title)},function(){if(this.title.indexOf("{{")>=0&&this.title.indexOf("}}")>=0)for(var c=j(this),d=0,e=c.length;e>d;++d)document.title=a.parameter.extrapolate(this.title,a.hash.getHash(),c[d]);else document.title=this.title;b.apply(this,arguments)}),a.state.chain.add(!0,"include",function(){return"include"in this||"data"in this?!0:!1},function(){var c=a.hash.getHash(),d=j(this),e=arguments,g=a.last(e),k=this,l=a.callback.synchronizer(null,a.scope(function(){b.apply(this,e)},this),function(){a.state._errorState=k,g.error.apply(this,arguments)}),m=a.acl.getCurrentRole(),n=this.include&&this.include.partials?this.include.partials:{},o=i(this,"css",m),p=i(this,"js",m),q=i(this,"html",m),r=i(this,"translate",m);a.each(o,function(a){l.addCallback(f.call(this,"css",a))},this),a.each(p,function(a){l.addCallback(f.call(this,"js",a))},this),a.each(r,function(b){l.addCallback(f.call(this,"json",b,function(b){a.each(b,function(b,c){a.translate.add(c,b,!0)})}))},this);var s=null;(a.isArray(this._storm.data)||a.isTrueObject(this._storm.data))&&(s=a.differenceObject(this.data,this._storm.data)),this.data=a.deepClone(this._storm.data),this.options=a.deepClone(this._storm.options)||{type:"json"},a.isString(this.data)&&(this.data={url:this.data,options:a.clone(this.options),error:null,success:null}),a.isTrueObject(this.data)?"url"in this.data&&"options"in this.data?l.addCallback(h(this,null,this.data.url,this.data.options,null,null)):(a.each(this.data,function(b,c){a.isString(b)&&(b={url:b,options:this.options,error:null,success:null}),b.error=a.isFunction(b.error)?b.error:null,b.success=a.isFunction(b.success)?b.success:null,l.addCallback(h(this,c,b.url,b.options,b.success,b.error))},this),s&&a.each(s,function(a,b){this.data[b]=a},this)):a.isFunction(this.data)?l.addCallback(h(this,null,this.data,null,null,null)):a.console.storm("error","a.state.chain.include","The state ```"+this.id+"``` is not valid (data is not valid)",1),a.each(n,function(b,c){l.addCallback(function(d){a.template.partial(c,b,function(){d.next()},function(){d.error()})})}),l.addCallback(a.scope(function(b){var e=q[0];if(!e)return void b.next();for(var f=0,g=d.length;g>f;++f)e=a.parameter.extrapolate(e,c,d[f]);this._storm.html=e,a.template.get(e,{},b.next,b.error)},this)),l.start()}),a.state.chain.add(!0,"converter",function(){return"converter"in this&&a.isFunction(this.converter)},function(){this.converter.call(this,this.data),b.apply(this,arguments)}),a.state.chain.add(!0,"contentLoad",function(){return"include"in this&&"html"in this.include},function(){var d=a.toArray(arguments),e=a.last(d);a.template.get(this._storm.html,this.data,a.scope(function(f){var g=c.call(this);if(a.isFunction(this.type))this.type.call(this,g,f,e);else if(g){var h=a.dom.query(g),i=this.type||"replace",j=a.state.type.get(i);j&&a.isFunction(j.input)?j.async?j.input.call(this,h,f,e):(j.input.call(this,h,f),b.apply(this,d)):b.apply(this,d)}},this))}),a.state.chain.add(!0,"load",function(){return"load"in this&&a.isFunction(this.load)},function(){return d(this.async,"load")?void this.load.apply(this,arguments):(this.load.call(this),void b.apply(this,arguments))}),a.state.chain.add(!0,"bindDom",function(){return"bind"in this||"bindings"in this?!0:!1},function(){var d=this.bind||this.bindings||null,e=this,f=a.dom.el(c.call(this));a.each(d,function(b,c){var d=c.split("|");if(2==d.length){var g=a.trim(d[0]),h=a.trim(d[1]);h&&(g?a.dom.query(g,f).bind(h,b,e):f.bind(h,b,e))}else 1==d.length&&f.bind(a.trim(d[0]),b,e)}),b.apply(this,arguments)}),a.state.chain.add(!0,"bindGlobalDom",function(){return"globalBind"in this||"globalBindings"in this?!0:!1},function(){var c=this.globalBind||this.globalBindings||null,d=this;a.each(c,function(b,c){var e=c.split("|");if(2==e.length){var f=a.trim(e[0]),g=a.trim(e[1]);g&&a.dom.query(f).bind(g,b,d)}}),b.apply(this,arguments)}),a.state.chain.add(!0,"bindKeyboard",function(){return"keyboard"in this||"accelerator"in this?!0:!1},function(){var c=this.keyboard||this.accelerator||null;a.each(c,function(b,c){var d=c.split("|");a.each(d,function(c){var d=c.split(":"),e=a.trim(d[0]),f=d[1]?a.trim(d[1]):"keypress";f=f.toLowerCase(),"keypress"!=f&&"keydown"!=f&&"keyup"!=f&&(f="keypress"),a.keyboard.bind(e,b,this,f)},this)},this),b.apply(this,arguments)}),a.state.chain.add(!0,"postLoad",function(){return"postLoad"in this&&a.isFunction(this.postLoad)},function(){return d(this.async,"postLoad")?void this.postLoad.apply(this,arguments):(this.postLoad.call(this),void b.apply(this,arguments))}),a.state.chain.add(!0,"loadAfter",function(){return"loadAfter"in this&&!a.isNone(this.loadAfter)},function(){var c=this.loadAfter;a.isArray(c)?a.each(c,function(b){a.state.load(b)}):(a.isString(c)||a.isNumber(c))&&a.state.load(c),b.apply(this,arguments)}),a.state.chain.add(!1,"preUnload",function(){return"preUnload"in this&&a.isFunction(this.preUnload)},function(){return d(this.async,"preUnload")?void this.preUnload.apply(this,arguments):(this.preUnload.call(this),void b.apply(this,arguments))}),a.state.chain.add(!1,"unbindKeyboard",function(){return"keyboard"in this||"accelerator"in this?!0:!1},function(){var c=this.keyboard||this.accelerator||null;a.each(c,function(b,c){var d=c.split("|");a.each(d,function(c){var d=c.split(":"),e=a.trim(d[0]),f=d[1]?a.trim(d[1]):"keypress";f=f.toLowerCase(),"keypress"!=f&&"keydown"!=f&&"keyup"!=f&&(f="keypress"),a.keyboard.unbind(e,b,f)},this)},this),b.apply(this,arguments)}),a.state.chain.add(!1,"unbindGlobalDom",function(){return"globalBind"in this||"globalBindings"in this?!0:!1},function(){var c=this.globalBind||this.globalBindings||null;a.each(c,function(b,c){var d=c.split("|");if(2==d.length){var e=a.trim(d[0]),f=a.trim(d[1]);f&&a.dom.query(e).unbind(f,b)}}),b.apply(this,arguments)}),a.state.chain.add(!1,"unbindDom",function(){return"bind"in this||"bindings"in this?!0:!1},function(){var d=this.bind||this.bindings||null,e=a.dom.el(c.call(this));a.each(d,function(b,c){var d=c.split("|");if(2==d.length){var f=a.trim(d[0]),g=a.trim(d[1]);g&&(f?a.dom.query(f,e).unbind(g,b):e.unbind(g,b))}else 1==d.length&&e.unbind(a.trim(d[0]),b)}),b.apply(this,arguments)}),a.state.chain.add(!1,"unload",function(){return"unload"in this&&a.isFunction(this.unload)},function(){return d(this.async,"unload")?void this.unload.apply(this,arguments):(this.unload.call(this),void b.apply(this,arguments))}),a.state.chain.add(!1,"contentUnload",function(){var b=c.call(this);return b?a.isFunction(b)||a.isString(b):!1},function(){var d=null,e=c.call(this),f=a.toArray(arguments);if(a.isFunction(e)?d=a.dom.el(e()):a.isString(e)&&(d=a.dom.query(e)),d){var g=this.type||"replace",h=a.state.type.get(g);if(h&&a.isFunction(h.output))if(h.async){var i=a.last(f);h.output.call(this,d,i)}else h.output.call(this,d),b.apply(this,f);else b.apply(this,f)}b.apply(this,arguments)}),a.state.chain.add(!1,"postUnload",function(){return"postUnload"in this&&a.isFunction(this.postUnload)},function(){return d(this.async,"postUnload")?void this.postUnload.apply(this,arguments):(this.postUnload.call(this),void b.apply(this,arguments))}),a.state.chain.add(!1,"removeParameters",function(){return"hash"in this&&!a.isNone(this.hash)},function(){try{delete this.parameters}catch(a){}b.apply(this,arguments)})}(),a.state.type=new function(){var b=a.mem.getInstance("app.state.type");this.add=function(a,c,d,e){b.set(a,{input:c,output:d,async:e})},this.remove=function(a){b.remove(a)},this.get=function(a){return b.get(a)},this.list=function(){return b.list()}},a.state.protocol=new function(){var b=a.mem.getInstance("app.state.protocol");this.add=function(a,c,d){d=d===!0?!0:!1,b.set(a,{isDefault:d,fn:c})},this.remove=function(a){b.remove(a)},this.get=function(a){return b.get(a)},this.tester=function(c){if(a.isNone(c))return null;var d=b.list(),e=null;for(var f in d){if(0===c.indexOf(f))return f;a.isNull(e)&&d[f].isDefault&&(e=f)}var g=/^([a-zA-Z0-9\-\_]*):\/\//i,h=g.exec(c);return h&&h[1]!==e?null:e}},function(){a.state.protocol.add("url",function(b,c){var d=a.isArray(b.hash)?b.hash[c]:null;return d&&0===d.indexOf("url://")?d.substring(6):d},!0),a.state.protocol.add("uri",function(b,c){var d=a.isArray(b.hash)?b.hash[c]:"";d&&0===d.indexOf("uri://")&&(d=d.substring(6));for(var e=b.parent;!a.isNone(e);){if(e.hash){for(var f=!1,g=0,h=e.hash.length;h>g;++g){var i=a.state.protocol.tester(e.hash[g]);if(!a.isNull(i)){var j=a.state.protocol.get(i),k=j.fn(e,g);d=k+"/"+d,f=!0;break}}if(f)break}e=e.parent}return d},!1),a.state.protocol.add("model",function(a,b){},!1)}(),a.binding=function(){function b(b,c){c=c||i;var d=a.dom.el(b).attribute(c);return a.isString(d)?d:d.length>0?d[0]:null}function c(b){if(a.contains(j,b.nodeName))return b.value;for(var c="",d=0,e=b.childNodes.length;e>d;++d){var f=b.childNodes[d];3==f.nodeType&&(c+=f.nodeValue)}return c}function d(c,d,e){c=this||c,d=b(c)||d,e=e||c.value,a.dom.attr(i,d).each(function(b){c&&this===c||(a.contains(j,this.nodeName)?this.value=b:this.innerHTML=b)},e)}function e(a){d.call(a.target)}function f(b){var c=[];return a.dom.el(b||document).attr(i).each(function(){a.contains(j,this.nodeName)&&(c.push(this),a.dom.el(this).bind("change input keydown",e),d.call(this))}),c}function g(b){var c=[];return a.dom.el(b||document).attr(i).each(function(){a.contains(j,this.nodeName)&&(c.push(this),a.dom.el(this).unbind("change input keydown",e))}),c}function h(b){b=b||document;var d=/\{\{\s*(\w+)\s*\}\}/gi;a.dom.el(b).all().each(function(){d.lastIndex=0;var a=c(this);if(a&&-1!=a.indexOf("{{")&&-1!=a.indexOf("}}")&&d.test(a)){{a.match(d)}d.lastIndex=0,console.log(a.replace(d,""))}})}var i=["data-bind","a-bind","bind"],j=["INPUT","TEXTAREA"];return{bind:function(a){return f(a)},unbind:function(a){return g(a)},manual:function(a,b){d(null,a,b)},refresh:function(a){return g(a),f(a)},watchInnerBind:function(a){h(a)},unwatchInnerBind:function(a){unbindInner(a)}}}(),a.model=function(b,c){if(a.isString(b))return a.model.pooler.get(b)?a.model.pooler.createInstance(b):(a.model.pooler.set(b,{properties:c}),a.setTemplateAjaxOptions("model:"+b,{model:b,type:"json"}),function(){return a.model.pooler.createInstance(b)});if(a.isTrueObject(b)){if(!("destroy"in b))return a.model.pooler.searchInstance(b);var d=b.instances;if(d&&a.isArray(d))for(var e=d.length;e--;)a.model.pooler.deleteInstance(d[e])}},a.modelInstance=function(b,c){this.modelName=b||"",this.properties={},this.snapshot={},this.originalContent=[],this.uid=a.uniqueId(),this.nid=b+"-"+this.uid,a.isTrueObject(c)&&(this.properties=a.deepClone(c));for(var d in this)this.originalContent.push(d)},a.modelInstance.prototype={get:function(a){var b=this.properties[a];return b?b.value:null},type:function(b){var c=this.properties[b];if(!c)return"text";if(c.type)return c.type;if(c.primary===!0)return"hidden";if(a.isArray(c.check))return"select";if(c.check){var d=c.check.toLowerCase();if("boolean"===d)return"checkbox";if("number"===d||"float"===d||"double"===d||"integer"===d)return"number"}return"text"},list:function(){var a=[];for(var b in this.properties)a.push(b);return a},set:function(b,c){var d=this.properties[b];if(d){var e=d.check,f=d.apply,g=d.event,h=d.pattern,i=d.transform,j=d.validate,k=d.many||!1,l=d.value;if(c=a.isFunction(i)?i(c,l):c,d.nullable===!1&&a.isNone(c))return;if(a.isString(e)){e=e.toLowerCase(),("integer"===e||"float"===e||"double"===e)&&(e="number");var m=c instanceof a.modelInstance;if(m&&e!==c.modelName)return;if(!m&&e!==typeof c)return}else if(a.isArray(e)){if(!a.contains(e,c))return}else if(a.isTrueObject(e)&&!a.has(e,c))return;if(!a.isNone(c)&&a.isString(h)&&h)if(k===!0&&a.isArray(c))for(var n=0,o=c.length;o>n;++n){var p=new RegExp(h,"g");if(!p.test(c[n]))return}else{var p=new RegExp(h,"g");if(!p.test(c))return}if(a.isFunction(j)&&j(c,l)!==!0)return;if(a.isString(j)&&!new RegExp(j,"gi").test(c))return;d.value=c,a.contains(this.originalContent,b)||(this[b]=c),a.isFunction(f)&&f(c,l),g&&this.dispatch(g,{value:c,old:l})}},watch:function(b,c){a.isString(b)&&a.isFunction(c)?a.watch.call(this,this.properties[b].value,c):a.console.storm("error","a.model.watch","Unable to watch the property ```"+b+"``` for model ```"+this.modelName+"```",1)},unwatch:function(b,c){a.isString(b)&&a.isFunction(c)?a.unwatch.call(this,this.properties[b].value,c):a.console.storm("error","a.model.unwatch","Unable to unwatch the property ```"+b+"``` for model ```"+this.modelName+"```",1)},has:function(a){return a in this.properties},init:function(){for(var b in this.properties)this.properties[b].value=this.properties[b].init||null,a.contains(this.originalContent,b)?a.console.storm("error","a.model","The model ```"+this.modelName+"``` has the property ```"+key+"``` which is in conflict with internal model system. Please change the property name...",1):this[b]=this.get(b);this.takeSnapshot(),this.dispatch("init",{})},clone:function(){var b=a.deepClone(this.toObject()),c=a.model.pooler.createInstance(this.modelName);return c.fromObject(b),c},toObject:function(){var b={};for(var c in this.properties){var d=this.get(c);if(d instanceof a.modelInstance)b[c]=d.toObject();else if(a.isArray(d)){for(var e=[],f=0,g=d.length;g>f;++f){var h=d[f];e.push(h instanceof a.modelInstance?h.toObject():h)}b[c]=e}else b[c]=d}return b},fromObject:function(a){for(var b in this.properties)b in a&&(this.properties[b].value=a[b])},toJSON:function(){return a.parser.json.stringify(this.toObject())},fromJSON:function(b){a.isString(b)&&b.length>0&&(b=a.parser.json.parse(b)),this.fromObject(b)},takeSnapshot:function(){this.snapshot={};for(var a in this.properties)this.snapshot[a]=this.get(a);return this.getSnapshot()},getSnapshot:function(){return this.snapshot},differenceSnapshot:function(a){var b=this.snapshot,c=this.properties,d={};for(var e in b){var f=b[e],g=c[e].value;(g!==f||c[e].needed===!0)&&(a?d[e]=g:d[e]={value:g,old:f})}return d}},function(){a.parameter.addParameterType("model",function(b){return a.model.manager.get(b)}),Handlebars.registerHelper("model",function(b){return a.isString(b)||a.isNumber(b)?b:a.isTrueObject(b)&&b.uid?b.uid:null})}(),a.model.manager={_store:a.mem.getInstance("app.model.instance"),set:function(a){this._store.set(a.uid,a)},get:function(a){return this._store.get(a)},remove:function(a){this._store.remove(a)},list:function(){return this._store.list()},clear:function(){this._store.clear()},getByName:function(b){if(!b||!a.isString(b))return[];var c=[];return a.each(this._store.list(),function(a){a.modelName===b&&c.push(a)}),c}},a.model.pooler=a.mem.getInstance("app.model.type"),a.model.pooler.createInstance=function(b){var c=this.createTemporaryInstance(b);return a.isNull(c)||a.model.manager.set(c),c},a.model.pooler.createTemporaryInstance=function(b){var c=this.get(b);if(!c)return null;var d=a.extend(new a.modelInstance(b,a.clone(c.properties)),new a.eventEmitter("a.model"));return d.init(),d},a.model.pooler.searchInstance=function(b){var c,d=b.modelName||b.model||b.name||null;if(d&&a.isString(d))c=a.model.manager.getByName(d);else{var e=a.model.manager.list(),c=[];a.each(e,function(a){c.push(a)})}b.modelName?delete b.modelName:b.model?delete b.model:b.name&&delete b.name;for(var f in b)for(var g=b[f],h=c.length;h--;){var i=c[h];a.isTrueObject(g)||i.get(f)===g?a.isTrueObject(g):c.splice(h,1)}return c},a.model.pooler.getPrimary=function(a){var b=this.get(a);if(!b)return null;var c=b.properties,d=[];for(var e in c){var f=c[e];"primary"in f&&f.primary===!0&&d.push(e)}return d},a.model.pooler.deleteInstance=function(b){a.isTrueObject(b)&&b.uid&&a.model.manager.remove(b.uid)},a.model.template={engine:"raw",generator:a.mem.getInstance("app.model.template.engine"),descriptor:a.mem.getInstance("app.model.template.render"),getDescriptor:function(b,c,d,e){var f="rendering"in e&&a.isTrueObject(e.rendering)?e.rendering:null,g=a.model.template.generator.get(a.model.template.engine),h="rendering"in g&&a.isTrueObject(g.rendering)?g.rendering:null,i="a.model.template.getDescriptor";(a.isNone(g)||a.isNone(h))&&a.console.storm("error",i,"Unable to find the ```"+a.model.template.engine+"``` engine",1);var j="Unable to find descriptor for ```"+d+"``` with engine ```"+a.model.template.engine+"``` and template ```"+e.templateName+"```";if("column"===b||"row"===b||"fieldset"===b||"clearfix"===b){var k=b+d;return f&&a.isFunction(f[k])?f[k]:h&&a.isFunction(h[k])?h[k]:f&&a.isFunction(f[b])?f[b]:h&&a.isFunction(h[b])?h[b]:(a.console.storm("error",i,j,1),null)}if("input"===b){if(f){if(a.isFunction(f[d]))return f[d];if(a.isFunction(f[c]))return f[c]}return h&&a.isFunction(h[c])?h[c]:f&&a.isFunction(f[b])?f[b]:h&&a.isFunction(h[b])?h[b]:(a.console.storm("error",i,j,1),null)}return a.console.storm("error","a.model.template.getDescriptor","The type ```"+b+"``` is unknow",1),null},output:{input:function(b,c,d,e){var f=b.type(c),g=b.get(c),h=a.model.template.getDescriptor("input",f,c,e);if(a.isFunction(h)){var i=c,j="",k="";return h.call(this,b,c,f,i,g,j,k,d)}return null},column:function(b,c,d,e){var f=a.model.template.getDescriptor("column",null,c,d);return a.isFunction(f)?f.call(this,c,e):null},row:function(b,c,d,e){var f=c.split("&&"),g=null,h=a.model.template.getDescriptor("row",null,d,e),i=null,j=["left","right","justify","center"];if(1===f.length)for(var k=f[0].split("::"),l=0,m=k.length;m>l;++l){var n=a.trim(k[l]);a.contains(j,n)&&(i=n)}g=a.isFunction(h)?h.call(this,d,e,{
position:i}):document.createElement("div");for(var o=0,p=f.length;p>o;++o){var q=a.trim(f[o]);i=null;var r=q.split("::"),s=null;if(""===r[0]&&0===r[1].indexOf("col")&&(s=this.column.call(this,b,r[1],e)))g.appendChild(s);else{if(r.length>1){for(var t=r.length,u=r.length;t--;)r[t]=a.trim(r[t]),a.contains(j,r[t])&&(i=r[t]);for(t=0;u>t;++t){var v=r[t];0===v.indexOf("col")&&(s=this.column.call(this,b,v,e,{position:i}))}}var w=this.input.call(this,b,r[0],r.splice(1),e);s?(s.appendChild(w),g.appendChild(s)):g.appendChild(w)}}var x=a.model.template.getDescriptor("clearfix",null,d,e);return a.isFunction(x)&&g.appendChild(x.call(this,d,e)),g},fieldset:function(b,c,d,e){for(var f=a.model.template.getDescriptor("fieldset",null,d,e),g=0,h=c.length;h>g;++g){var i=a.trim(c[g]),j=null;i[g].indexOf("legend")||(j=this.row.call(this,b,i,g,e)),j&&f.appendChild(j)}return f},model:function(b,c){var d=a.model.template.descriptor.get(c);if(!d)return void a.console.storm("error","a.model.template.output.model","The template ```"+c+"``` could not be found",1);var e=d.template,f=[];d.templateName=c;for(var g=0,h=e.length;h>g;++g)f.push(a.isArray(e[g])?this.fieldset.call(this,b,e[g],g,e):this.row.call(this,b,e[g],g,e));return f}}},function(){a.model.template.generator.set("raw",{rendering:{row:function(b,c,d){var e=document.createElement("div");return a.isString(d.position)&&(e.style.textAlign=d.position),e},clearfix:function(){var a=document.createElement("div");return a.style.clear="both",a.style.height="0px",a.style.overflow="hidden",a},column:function(b,c){var d=document.createElement("div");b=parseInt(b.match(/[0-9]+/)[0],10);var e=Math.round(8.33333333*b*1e5)/1e5;return d.style.styleFloat="left",d.style.cssFloat="left",d.style.width=e+"%",a.isString(c.position)&&(d.style.textAlign=c.position),d},reset:function(a){var b=document.createElement("input");return b.type="reset",a&&(b.value=a),b},submit:function(a){var b=document.createElement("submit");return b.type="submit",a&&(b.value=a),b},input:function(b,c,d,e,f,g,h,i){var j=a.contains(i,"static"),k=document.createElement("div"),l=document.createElement("label"),m=null,n="model-"+c;if(l["for"]=n,l.className=g,l.innerHTML=e,j)m=document.createElement("p"),m.innerHTML=f||"";else if("textarea"===d)m=document.createElement("textarea"),m.innerHTML=f||"";else if("select"===d){m=document.createElement("select");for(var o=["opt1","opt2"],p=0,q=o.length;q>p;++p){var r=document.createElement("option");r.value=o[p],r.innerHTML=o[p],m.appendChild(r)}}else m=document.createElement("input"),m.type=d,m.placeholder=e,m.value=f||"";if(m.id=n,m.className=h,!j){m.name=c,m.id=n;for(var p=0,q=i.length;q>p;++p){var s=a.trim(i[p]);("disable"===s||"disabled"===s)&&(m.disabled=!0)}}return k.appendChild(l),k.appendChild(m),k}}})}(),a.template={_part:{},_tmpl:{},partial:function(b,c,d,e){var f=a.isTrueObject(window.Handlebars)?window.Handlebars:null,g="a.template.partial";if(!f)return void a.console.storm("error",g,"Unable to find Handlebars.js!",1);var h=this._part;a.isString(h[b])?(a.console.storm("log",g,"Loading ```"+b+"``` from cache",3),a.isFunction(d)&&d(b,h[b])):e&&1==e.noloading?(a.console.storm("log",g,"Loading ```"+b+"``` from parameter",3),h[b]=c,f.registerPartial(b,c),a.isFunction(d)&&d(b,c)):a.loader.html(c,function(c){a.console.storm("log",g,"Loading ```"+b+"``` from url",3),h[b]=c,f.registerPartial(b,c),a.isFunction(d)&&d(b,c)})},get:function(b,c,d,e){var f=a.isTrueObject(window.Handlebars)?window.Handlebars:null,g="a.template.get";if(!f)return void a.console.storm("error",g,"Unable to find Handlebars.js!",1);var h=b.replace(/[^a-zA-Z0-9\\-]/g,"_"),i="a_tmpl_"+h,j=function(b,c,d){if(a.isFunction(b))if(a.isNone(f.to_html)){var e=f.compile(a.template._tmpl[c]);b(e(d))}else b(f.to_html(a.template._tmpl[c],d))};if(a.isString(this._tmpl[i]))return a.console.storm("log",g,"Loading ```"+i+"``` from cache",3),void j(d,i,c);if(document.getElementById(i))return this._tmpl[i]||(a.console.storm("log",g,"Loading ```"+i+"``` from inner html page",3),this._tmpl[i]=a.dom.id(i).html()),void j(d,i,c);if(document.getElementById(h))return this._tmpl[h]||(a.console.storm("log",g,"Loading ```"+h+"``` from inner html page",3),this._tmpl[h]=a.dom.id(h).html()),void j(d,h,c);var k=function(b,e,f){a.template._tmpl[i]||(a.template._tmpl[i]=b),j(d,i,c)};a.console.storm("log",g,"Loading ```"+b+"``` from external resource",3),a.loader.html(b,k,{},e)},htmlToDom:function(b){var c=document.createElement("div"),d=[];return c.innerHTML=a.trim(b),a.dom.el(c).children([1,3]).each(function(){d.push(this)}),d},remove:function(b,c){a.dom.el(b).empty(),a.isFunction(c)&&c()},append:function(b,c,d){b=a.dom.el(b);var e=this.htmlToDom(c);a.isTrueObject(e)&&b.append(e),a.each(b.getElements(),function(b){a.translate.translate(b)}),a.isFunction(d)&&d(c)},replace:function(b,c,d){this.remove(b,function(){a.template.append(b,c,d)})}},function(){a.state.type.add("replace",function(b,c,d){c&&a.template.replace(b,c,function(){d&&d.next()})},function(a,b){b&&b.next()},!0),a.state.type.add("append",function(b,c,d){c&&a.template.append(b,c,function(){d&&d.next()})},function(a,b){b&&b.next()},!0)}(),a.message.dispatch("ready");